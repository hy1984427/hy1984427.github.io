<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Test &amp; testing &amp; tester</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Huang Yong&apos;s personal blogs about testing.">
<meta property="og:type" content="website">
<meta property="og:title" content="Test &amp; testing &amp; tester">
<meta property="og:url" content="http://hy1984427.github.io/index.html">
<meta property="og:site_name" content="Test &amp; testing &amp; tester">
<meta property="og:description" content="Huang Yong&apos;s personal blogs about testing.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Test &amp; testing &amp; tester">
<meta name="twitter:description" content="Huang Yong&apos;s personal blogs about testing.">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '73216141', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/AboutMe.html">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://hy1984427.github.io"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-Configure_ServerSpec_To_Run_Tests_Against_Multiple_Hosts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/18/Configure_ServerSpec_To_Run_Tests_Against_Multiple_Hosts/">Configure ServerSpec to run tests against multiple hosts</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/09/18/Configure_ServerSpec_To_Run_Tests_Against_Multiple_Hosts/" class="article-date">
  <time datetime="2017-09-17T14:00:00.000Z" itemprop="datePublished">2017-09-18</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="We-have-learnt-how-to-setup-tests-with-ServerSpec-in-Quick-start-for-ServerSpec-and-Testinfra-also-comparison-of-them-but-the-folder-structure-can-only-support-testing-against-one-host-In-the-real-world-we-need-to-reuse-the-tests-to-test-against-multiple-hosts-so-we-will-see-how-we-can-do-that"><a href="#We-have-learnt-how-to-setup-tests-with-ServerSpec-in-Quick-start-for-ServerSpec-and-Testinfra-also-comparison-of-them-but-the-folder-structure-can-only-support-testing-against-one-host-In-the-real-world-we-need-to-reuse-the-tests-to-test-against-multiple-hosts-so-we-will-see-how-we-can-do-that" class="headerlink" title="We have learnt how to setup tests with ServerSpec in Quick start for ServerSpec and Testinfra, also comparison of them, but the folder structure can only support testing against one host. In the real world, we need to reuse the tests to test against multiple hosts, so we will see how we can do that."></a>We have learnt how to setup tests with ServerSpec in <a href="http://hy1984427.github.io/2017/09/01/Qucik_Start_For_ServerSpec_and_TestInfra_also_comparison_of_them/">Quick start for ServerSpec and Testinfra, also comparison of them</a>, but the folder structure can only support testing against one host. In the real world, we need to reuse the tests to test against multiple hosts, so we will see how we can do that.</h5><h3 id="Prerequisite"><a href="#Prerequisite" class="headerlink" title="Prerequisite:"></a>Prerequisite:</h3><p>  ServerSpec setup is completed according to the steps in <a href="http://hy1984427.github.io/2017/09/01/Qucik_Start_For_ServerSpec_and_TestInfra_also_comparison_of_them/">Quick start for ServerSpec and Testinfra, also comparison of them</a>.</p>
<h3 id="Configure-ServerSpec-to-run-tests-against-multiple-hosts"><a href="#Configure-ServerSpec-to-run-tests-against-multiple-hosts" class="headerlink" title="Configure ServerSpec to run tests against multiple hosts:"></a>Configure ServerSpec to run tests against multiple hosts:</h3><p>  Actually we only need to change the Rakefile in the test folder. And its content should be changed to following:</p>
  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">'rake'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'rspec/core/rake_task'</span></div><div class="line"></div><div class="line">hosts = <span class="string">%w(</span></div><div class="line">  host1</div><div class="line">  host2</div><div class="line">)</div><div class="line"></div><div class="line">task <span class="symbol">:spec</span> =&gt; <span class="string">'spec:all'</span></div><div class="line"></div><div class="line">namespace <span class="symbol">:spec</span> <span class="keyword">do</span></div><div class="line"></div><div class="line">  task <span class="symbol">:all</span> =&gt; hosts.map &#123;<span class="params">|h|</span> <span class="string">'spec:'</span> + h &#125;</div><div class="line">  hosts.each <span class="keyword">do</span> <span class="params">|host|</span></div><div class="line">    desc <span class="string">"Run serverspec to <span class="subst">#&#123;host&#125;</span>"</span></div><div class="line">    RSpec::Core::RakeTask.new(host) <span class="keyword">do</span> <span class="params">|t|</span></div><div class="line">      ENV[<span class="string">'TARGET_HOST'</span>] = host</div><div class="line">      t.pattern = <span class="string">"spec/&#123;host_server&#125;/*_spec.rb"</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>  Please note, <code>host1</code> and <code>host2</code> are the hosts we would like to run our tests against, the reason we put <code>host_server</code> in above lines is because we have the folder named “host_server” in our test scripts structure.</p>
<p>  You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/ServerSpecAdvanced.zip" target="_blank" rel="external">here</a>.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Advanced/">Advanced</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Infrastructure-Testing/">Infrastructure Testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Multiple-Hosts/">Multiple Hosts</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ServerSpec/">ServerSpec</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Integrate_ServerSpec_Testinfra_and_ZAP_with_CentOS_7_Minimal" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/07/Integrate_ServerSpec_Testinfra_and_ZAP_with_CentOS_7_Minimal/">Integrate ServerSpec, Testinfra and ZAP with CentOS 7 Minimal</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/09/07/Integrate_ServerSpec_Testinfra_and_ZAP_with_CentOS_7_Minimal/" class="article-date">
  <time datetime="2017-09-06T14:00:00.000Z" itemprop="datePublished">2017-09-07</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="We-already-know-how-to-setup-tests-with-ServerSpec-and-Testinfra-in-Quick-start-for-ServerSpec-and-Testinfra-also-comparison-of-them-and-Quick-start-for-integrating-ZAP-into-CI-Now-let’s-see-how-to-integrate-them-with-CentOS-7-Minimal"><a href="#We-already-know-how-to-setup-tests-with-ServerSpec-and-Testinfra-in-Quick-start-for-ServerSpec-and-Testinfra-also-comparison-of-them-and-Quick-start-for-integrating-ZAP-into-CI-Now-let’s-see-how-to-integrate-them-with-CentOS-7-Minimal" class="headerlink" title="We already know how to setup tests with ServerSpec and Testinfra in Quick start for ServerSpec and Testinfra, also comparison of them and Quick start for integrating ZAP into CI. Now, let’s see how to integrate them with CentOS 7 Minimal."></a>We already know how to setup tests with ServerSpec and Testinfra in <a href="http://hy1984427.github.io/2017/09/01/Qucik_Start_For_ServerSpec_and_TestInfra_also_comparison_of_them/">Quick start for ServerSpec and Testinfra, also comparison of them</a> and <a href="http://hy1984427.github.io/2017/09/06/Qucik_Start_For_Integrating_ZAP_into_CI/">Quick start for integrating ZAP into CI</a>. Now, let’s see how to integrate them with CentOS 7 Minimal.</h5><h3 id="Prerequisite"><a href="#Prerequisite" class="headerlink" title="Prerequisite:"></a>Prerequisite:</h3><ol>
<li><p>Install CentOS 7 Minimal successfully with root user setup and login.</p>
</li>
<li><p>Enable network on CentOS 7 Minimal following <a href="https://lintut.com/how-to-setup-network-after-rhelcentos-7-minimal-installation/" target="_blank" rel="external">this article</a>.</p>
<p>The detailed steps are:</p>
<p>1) Open Network Manager through <code>nmtui</code>;</p>
<p>2) Choose “Edit connection” and press Enter (Use TAB button for choosing options);</p>
<p>3) Choose your network interfaces and click “Edit”;</p>
<p>4) Choose “Automatic” in “IPv4 CONFIGURATION” and check “Automatically connect” checkbox, then press “OK” to quit from Network Manager;</p>
<p>5) Reset network services through <code>service network restart</code>.</p>
</li>
<li><p>Adjust the screen resolution following <a href="https://superuser.com/questions/816528/with-centos-7-as-a-virtualbox-guest-on-a-mac-host-how-can-i-change-the-screen-r" target="_blank" rel="external">this article</a>.</p>
<p>The detailed steps are:</p>
<p>1) Edit GRUB file: <code>vi /etc/default/grub</code></p>
<p>2) Append <code>vga=792</code> to the line <code>GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=cl/root rd.lvm.lv=cl/swap rhgb quiet</code>,</p>
<p>and you will have <code>GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=cl/root rd.lvm.lv=cl/swap rhgb quiet vga=792</code>;</p>
<p><em>Check for the detailed <a href="#GRUB-VGA-Modes">GRUB VGA Modes</a>, or scroll down to the bottom of this article.</em></p>
<p>3) Add this change to GRUB configuration: <code>grub2-mkconfig -o /boot/grub2/grub.cfg</code></p>
<p>4) Reboot to take effect: <code>reboot</code>.</p>
</li>
<li><p>Add a Yum source and update.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum <span class="keyword">install</span> epel-<span class="keyword">release</span></div><div class="line">yum -y <span class="keyword">update</span></div></pre></td></tr></table></figure>
</li>
<li><p>Configure ssh key to connect server easily.</p>
<ul>
<li>Generate ssh key: <code>ssh-keygen -t rsa</code></li>
<li>Copy ssh public key to server: <code>ssh-copy-id -i ~/.ssh/id_rsa.pub username@server</code></li>
<li><p>Add following lines to ~/.ssh/config.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Host<span class="built_in"> server</span></div><div class="line"> <span class="built_in"> User </span>username</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h3 id="Quick-start-for-ServerSpec"><a href="#Quick-start-for-ServerSpec" class="headerlink" title="Quick start for ServerSpec:"></a>Quick start for ServerSpec:</h3><ol>
<li><p>Install Ruby.</p>
<p><code>yum install ruby</code></p>
</li>
<li><p>Install all necessary libraries.</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">yum install gcc g++ <span class="keyword">make</span> automake autoconf curl-devel openssl-devel zlib-devel httpd-devel apr-devel apr-util-devel sqlite-devel wget</div><div class="line"></div><div class="line">yum install <span class="keyword">ruby</span>-rdoc <span class="keyword">ruby</span>-devel</div></pre></td></tr></table></figure>
</li>
<li><p>Install RubyGems.</p>
<p><code>yum install rubygems</code></p>
</li>
<li><p>Install Rake.</p>
<p><code>gem install rake</code></p>
</li>
<li><p>Install ServerSpec.</p>
<p><code>gem install serverspec</code></p>
</li>
<li><p>Initial ServerSpec folder with basic settings. Please note the server will be set in this step.</p>
<p><code>serverspec-init</code></p>
</li>
<li><p>Write and run the ServerSpec script according to its <a href="http://serverspec.org/resource_types.html" target="_blank" rel="external">API document</a>.</p>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/ServerSpec.zip" target="_blank" rel="external">here</a>.</p>
<p>Using <code>rake spec</code> under the test folder to run and check the result.</p>
</li>
<li><p>To run specific test rather than the entire test suite.</p>
<p> Using <code>rake spec spec/host_server/sample_spec.rb</code> under the test folder to run and check the result.</p>
</li>
</ol>
<h3 id="Quick-Start-for-Testinfra"><a href="#Quick-Start-for-Testinfra" class="headerlink" title="Quick Start for Testinfra:"></a>Quick Start for Testinfra:</h3><ol>
<li><p>Python 2.7 is installed by default, so we just need to install Pip.</p>
<figure class="highlight plain"><figcaption><span>-y install python-pip</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install --upgrade pip</div></pre></td></tr></table></figure>
</li>
<li><p>Install Testinfra and Paramiko.</p>
<p><code>pip install testinfra</code><br><code>pip install paramiko</code></p>
</li>
<li><p>Write and run the Testinfra script according to its <a href="http://testinfra.readthedocs.io/en/latest/modules.html" target="_blank" rel="external">API document</a>.</p>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/testinfra_test.py" target="_blank" rel="external">here</a>.</p>
<p>Using <code>testinfra testinfra_test.py</code> to run and check the result.</p>
</li>
<li><p>Some useful arguments we can use to make the test result more clear.</p>
<p>Instead of using <code>testinfra testinfra_test.py</code> directly, we can add some arguments, such as <code>-q</code>, <code>-s</code>, <code>--disable-warnings</code> and <code>--junit-xml</code>.</p>
<ul>
<li>The argument <code>-q</code> will run Testinfra in quiet mode, with less info exposed</li>
<li>The argument <code>-s</code> will let Testinfra capture No pre-test info</li>
<li>The argument <code>--disable-warnings</code> will disable warnings during Testinfra runs</li>
<li>The argument <code>--junit-xml</code> will export Testinfra test result into a xml file</li>
</ul>
<p>After adding those arguments, the command should be look like <code>testinfra -q -s --disable-warnings testinfra_test.py --junit-xml=report.xml</code></p>
</li>
<li><p>Now we can run Testinfra against the server using <code>testinfra -q -s --disable-warnings --ssh-config=/Path/to/ssh/config --hosts=server testinfra_test.py --junit-xml=report.xml</code>.</p>
</li>
</ol>
<h3 id="Quick-Start-for-ZAP"><a href="#Quick-Start-for-ZAP" class="headerlink" title="Quick Start for ZAP:"></a>Quick Start for ZAP:</h3><ol>
<li><p>Install JDK.</p>
<p><code>yum install java-1.8.0-openjdk*</code></p>
</li>
<li><p>Download ZAP installation script.</p>
<p><code>wget https://github.com/zaproxy/zaproxy/releases/download/2.6.0/ZAP_2_6_0_unix.sh</code></p>
</li>
<li><p>Change permission of the installation script and execute it.</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod 777 ZAP_2_6_0_unix.<span class="keyword">sh</span></div><div class="line">./ZAP_2_6_0_unix.<span class="keyword">sh</span></div></pre></td></tr></table></figure>
</li>
<li><p>Install required libraries.</p>
<p>1) Install Selenium-WebDriver</p>
<p><code>gem install selenium-webdriver</code></p>
<p>2) Install IO</p>
<p><code>gem install io</code></p>
<p>3) Install Rest-Client</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum <span class="keyword">install</span> gcc-c++</div><div class="line">gem <span class="keyword">install</span> rest-<span class="keyword">client</span></div></pre></td></tr></table></figure>
<p>4) Install RSpec</p>
<p><code>gem install rspec</code></p>
<p>5) Install and configure the headless Firefox</p>
 <figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">yum -y install firefox Xvfb libXfont Xorg</div><div class="line">yum -y groupinstall <span class="string">"X Window System"</span> <span class="string">"Desktop"</span> <span class="string">"Fonts"</span> <span class="string">"General Purpose Desktop"</span></div><div class="line">Xvfb :99 -ac -screen 0 1280x1024x24 &amp;</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">DISPLAY</span>=:99</div></pre></td></tr></table></figure>
<p>6) Download and setup geckodriver.</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget https://github.com/mozilla/geckodriver/releases/download/v0<span class="meta">.18</span><span class="meta">.0</span>/geckodriver-v0<span class="meta">.18</span><span class="meta">.0</span>-linux64.tar.gz</div><div class="line">tar -xvzf geckodriver-v0<span class="meta">.18</span><span class="meta">.0</span>-linux64.tar.gz</div><div class="line">mv geckodriver /usr/lib64</div></pre></td></tr></table></figure>
<p>7) Add following lines to ~/.bash_profile.</p>
<p> <code>$PATH=$PATH:/usr/lib64</code></p>
<p> And run <code>source ~/.bash_profile</code>.</p>
</li>
<li><p>Using <code>ruby add_assertions_to_check_zap_result.rb</code> to run and check the result.</p>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/add_assertions_to_check_zap_result.rb" target="_blank" rel="external">here</a>.</p>
</li>
</ol>
<h4 id="GRUB-VGA-Modes"><a href="#GRUB-VGA-Modes" class="headerlink" title="GRUB VGA Modes"></a><em>GRUB VGA Modes</em></h4><table>
<thead>
<tr>
<th style="text-align:center">Colour Depth</th>
<th style="text-align:center">640x480</th>
<th style="text-align:center">800x600</th>
<th style="text-align:center">1024x768</th>
<th style="text-align:center">1280x1024</th>
<th style="text-align:center">1400x1050</th>
<th style="text-align:center">1600x1200</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">8 (256)</td>
<td style="text-align:center">769</td>
<td style="text-align:center">771</td>
<td style="text-align:center">773</td>
<td style="text-align:center">775</td>
</tr>
<tr>
<td style="text-align:center">15 (32K)</td>
<td style="text-align:center">784</td>
<td style="text-align:center">787</td>
<td style="text-align:center">790</td>
<td style="text-align:center">793</td>
</tr>
<tr>
<td style="text-align:center">16 (65K)</td>
<td style="text-align:center">785</td>
<td style="text-align:center">788</td>
<td style="text-align:center">791</td>
<td style="text-align:center">794</td>
<td style="text-align:center">834</td>
<td style="text-align:center">884</td>
</tr>
<tr>
<td style="text-align:center">24 (16M)</td>
<td style="text-align:center">786</td>
<td style="text-align:center">789</td>
<td style="text-align:center">792</td>
<td style="text-align:center">795</td>
</tr>
</tbody>
</table>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CentOS-7-Minimal/">CentOS 7 Minimal</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Integration/">Integration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ServerSpec/">ServerSpec</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Testinfra/">Testinfra</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ZAP/">ZAP</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Qucik_Start_For_Integrating_ZAP_into_CI" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/06/Qucik_Start_For_Integrating_ZAP_into_CI/">Quick start for integrating ZAP into CI</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/09/06/Qucik_Start_For_Integrating_ZAP_into_CI/" class="article-date">
  <time datetime="2017-09-05T14:00:00.000Z" itemprop="datePublished">2017-09-06</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="OWASP-ZAP-is-widely-used-security-testing-tool-and-it’s-open-sourced-Let’s-see-how-we-can-integrate-it-with-our-automated-functionality-testing-in-CI"><a href="#OWASP-ZAP-is-widely-used-security-testing-tool-and-it’s-open-sourced-Let’s-see-how-we-can-integrate-it-with-our-automated-functionality-testing-in-CI" class="headerlink" title="OWASP ZAP is widely used security testing tool and it’s open sourced. Let’s see how we can integrate it with our automated functionality testing in CI."></a>OWASP ZAP is widely used security testing tool and it’s open sourced. Let’s see how we can integrate it with our automated functionality testing in CI.</h5><h3 id="Prerequisite"><a href="#Prerequisite" class="headerlink" title="Prerequisite:"></a>Prerequisite:</h3><p>  RVM, Ruby and rubygems are installed.</p>
<h3 id="Get-Started"><a href="#Get-Started" class="headerlink" title="Get Started:"></a>Get Started:</h3><ol>
<li><p>Download ZAP from <a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project" target="_blank" rel="external">OWASP_Zed_Attack_Proxy_Project</a> and install it.</p>
</li>
<li><p>Install Selenium-WebDriver, IO, Rest-Client and RSpec gems:</p>
<p>1) Install Selenium-WebDriver</p>
<p><code>gem install selenium-webdriver</code></p>
<p>2) Install IO</p>
<p><code>gem install io</code></p>
<p>3) Install Rest-Client</p>
<p><code>gem install rest-client</code></p>
<p>4) Install RSpec</p>
<p><code>gem install rspec</code></p>
</li>
<li><p>Write and run a basic Selenium-WebDriver script using Ruby. The script is the same as in my previous Gitbook <a href="http://hy1984427.github.io/BDD-with-PageObject/SimpleWebDriverTestByRuby/SimpleWebDriverTestByRuby.html">BDD with PageObject</a>.</p>
<p>The script will be like following:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">'selenium-webdriver'</span></div><div class="line"></div><div class="line">driver = Selenium::WebDriver.<span class="keyword">for</span> <span class="symbol">:firefox</span></div><div class="line"></div><div class="line">driver.get <span class="string">"http://www.google.com"</span></div><div class="line">element = driver.find_element <span class="symbol">:name</span> =&gt; <span class="string">"q"</span></div><div class="line">element.send_keys <span class="string">"Cheese!"</span></div><div class="line">element.submit</div><div class="line">p <span class="string">"Page title is <span class="subst">#&#123;driver.title&#125;</span>"</span></div><div class="line">wait = Selenium::WebDriver::Wait.new(<span class="symbol">:timeout</span> =&gt; <span class="number">10</span>)</div><div class="line">wait.<span class="keyword">until</span> &#123; driver.title.downcase.start_with? <span class="string">"cheese!"</span> &#125;</div><div class="line">p <span class="string">"Page title is <span class="subst">#&#123;driver.title&#125;</span>"</span></div><div class="line"></div><div class="line">driver.quit</div></pre></td></tr></table></figure>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/simple_script.rb" target="_blank" rel="external">here</a>.</p>
<p>Using <code>ruby simple_script.rb</code> to run and check the result.</p>
</li>
<li><p>Add steps to start ZAP and proxy the testing script using ZAP.</p>
<p>The script will become as following:</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">require 'selenium-webdriver'</div><div class="line"><span class="addition">+ require 'io/console'</span></div><div class="line"></div><div class="line"><span class="addition">+ system("pkill java") #To close any existing ZAP instance.</span></div><div class="line"><span class="addition">+ system("pkill firefox") #To close any existing Firefox instance.</span></div><div class="line"><span class="addition">+ IO.popen("/Applications/ZAP\\ 2.6.0.app/Contents/Java/zap.sh -daemon -config api.disablekey=true") #The path here should be the zap.sh path under ZAP package/folder on your machine; with the option -config api.disablekey=true, ZAP will not check the apikey, which is enable by default after ZAP 2.6.0</span></div><div class="line"><span class="addition">+ p "OWASP ZAP launch completed"</span></div><div class="line"><span class="addition">+ sleep 5 #To let ZAP start completely</span></div><div class="line"></div><div class="line"><span class="addition">+ profile = Selenium::WebDriver::Firefox::Profile.new</span></div><div class="line"><span class="addition">+ proxy = Selenium::WebDriver::Proxy.new(http: "localhost:8080") #Normally ZAP will listening at port 8080, if not, please change it to the actual port ZAP is listening</span></div><div class="line"><span class="addition">+ profile.proxy = proxy</span></div><div class="line"><span class="addition">+ options = Selenium::WebDriver::Firefox::Options.new(profile: profile)</span></div><div class="line"><span class="addition">+ driver = Selenium::WebDriver.for :firefox, options: options</span></div><div class="line"><span class="deletion">- driver = Selenium::WebDriver.for :firefox</span></div><div class="line"></div><div class="line">driver.get "http://www.google.com"</div><div class="line">element = driver.find_element :name =&gt; "q"</div><div class="line">element.send_keys "Cheese!"</div><div class="line">element.submit</div><div class="line">p "Page title is #&#123;driver.title&#125;"</div><div class="line">wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 10)</div><div class="line">wait.until &#123; driver.title.downcase.start_with? "cheese!" &#125;</div><div class="line">p "Page title is #&#123;driver.title&#125;"</div><div class="line"></div><div class="line">driver.quit</div></pre></td></tr></table></figure>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/add_zap_start.rb" target="_blank" rel="external">here</a>.</p>
<p>Using <code>ruby add_zap_start.rb</code> to run and check the result.</p>
</li>
<li><p>Read the test results from ZAP.</p>
<p>The script will become as following:</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">require 'selenium-webdriver'</div><div class="line">require 'io/console'</div><div class="line"><span class="addition">+ require 'rest-client'</span></div><div class="line"></div><div class="line">system("pkill java") #To close any existing ZAP instance.</div><div class="line">system("pkill firefox") #To close any existing Firefox instance.</div><div class="line">IO.popen("/Applications/ZAP\\ 2.6.0.app/Contents/Java/zap.sh -daemon -config api.disablekey=true") #The path here should be the zap.sh path under ZAP package/folder on your machine; with the option -config api.disablekey=true, ZAP will not check the apikey, which is enable by default after ZAP 2.6.0</div><div class="line">p "OWASP ZAP launch completed"</div><div class="line">sleep 5 #To let ZAP start completely</div><div class="line"></div><div class="line">profile = Selenium::WebDriver::Firefox::Profile.new</div><div class="line">proxy = Selenium::WebDriver::Proxy.new(http: "localhost:8080") #Normally ZAP will listening at port 8080, if not, please change it to the actual port ZAP is listening</div><div class="line">profile.proxy = proxy</div><div class="line">options = Selenium::WebDriver::Firefox::Options.new(profile: profile)</div><div class="line">driver = Selenium::WebDriver.for :firefox, options: options</div><div class="line"></div><div class="line">driver.get "http://www.google.com"</div><div class="line">element = driver.find_element :name =&gt; "q"</div><div class="line">element.send_keys "Cheese!"</div><div class="line">element.submit</div><div class="line">p "Page title is #&#123;driver.title&#125;"</div><div class="line">wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 10)</div><div class="line">wait.until &#123; driver.title.downcase.start_with? "cheese!" &#125;</div><div class="line">p "Page title is #&#123;driver.title&#125;"</div><div class="line"></div><div class="line"><span class="addition">+ JSON.parse RestClient.get "http://localhost:8080/json/core/view/alerts" #To trigger ZAP to raise alerts if any</span></div><div class="line"><span class="addition">+ sleep 5 #Give ZAP some time to process</span></div><div class="line"><span class="addition">+ response = JSON.parse RestClient.get "http://localhost:8080/json/core/view/alerts", params: &#123; zapapiformat: 'JSON', baseurl: "http://clients1.google.com", start: 1 &#125; #Get the alerts ZAP found, please note the baseurl will exact match from the beginning</span></div><div class="line"></div><div class="line">driver.quit</div><div class="line"><span class="addition">+ RestClient.get "http://localhost:8080/JSON/core/action/shutdown" #Close ZAP instance</span></div></pre></td></tr></table></figure>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/read_zap_result.rb" target="_blank" rel="external">here</a>.</p>
<p>Using <code>ruby read_zap_result.rb</code> to run and check the result.</p>
</li>
<li><p>Set up assertions to check the Low Risks.</p>
<p>The script will become as following:</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">require 'selenium-webdriver'</div><div class="line">require 'io/console'</div><div class="line">require 'rest-client'</div><div class="line"><span class="addition">+ require 'rspec/expectations'</span></div><div class="line"><span class="addition">+ include RSpec::Matchers</span></div><div class="line"></div><div class="line">system("pkill java") #To close any existing ZAP instance.</div><div class="line">system("pkill firefox") #To close any existing Firefox instance.</div><div class="line">IO.popen("/Applications/ZAP\\ 2.6.0.app/Contents/Java/zap.sh -daemon -config api.disablekey=true") #The path here should be the zap.sh path under ZAP package/folder on your machine; with the option -config api.disablekey=true, ZAP will not check the apikey, which is enable by default after ZAP 2.6.0</div><div class="line">p "OWASP ZAP launch completed"</div><div class="line">sleep 5 #To let ZAP start completely</div><div class="line"></div><div class="line">profile = Selenium::WebDriver::Firefox::Profile.new</div><div class="line">proxy = Selenium::WebDriver::Proxy.new(http: "localhost:8080") #Normally ZAP will listening at port 8080, if not, please change it to the actual port ZAP is listening</div><div class="line">profile.proxy = proxy</div><div class="line">options = Selenium::WebDriver::Firefox::Options.new(profile: profile)</div><div class="line">driver = Selenium::WebDriver.for :firefox, options: options</div><div class="line"></div><div class="line">driver.get "http://www.google.com"</div><div class="line">element = driver.find_element :name =&gt; "q"</div><div class="line">element.send_keys "Cheese!"</div><div class="line">element.submit</div><div class="line">p "Page title is #&#123;driver.title&#125;"</div><div class="line">wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 10)</div><div class="line">wait.until &#123; driver.title.downcase.start_with? "cheese!" &#125;</div><div class="line">p "Page title is #&#123;driver.title&#125;"</div><div class="line"></div><div class="line">JSON.parse RestClient.get "http://localhost:8080/json/core/view/alerts" #To trigger ZAP to raise alerts if any</div><div class="line">sleep 5 #Give ZAP some time to process</div><div class="line">response = JSON.parse RestClient.get "http://localhost:8080/json/core/view/alerts", params: &#123; zapapiformat: 'JSON', baseurl: "http://clients1.google.com", start: 1 &#125; #Get the alerts ZAP found</div><div class="line"><span class="addition">+ response['alerts'].each &#123;|x| p "#&#123;x['alert']&#125; risk level: #&#123;x['risk']&#125;"&#125; #Extract the risks found</span></div><div class="line"><span class="addition">+ events = response['alerts']</span></div><div class="line"><span class="addition">+ low_count = events.select&#123;|x| x['risk'] == 'Low'&#125;.size #Count the Low Risks</span></div><div class="line"><span class="addition">+ expect(low_count).to equal(1) #Expecxt only one Low Risk</span></div><div class="line"></div><div class="line">driver.quit</div><div class="line">RestClient.get "http://localhost:8080/JSON/core/action/shutdown" #Close ZAP instance</div></pre></td></tr></table></figure>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/add_assertions_to_check_zap_result.rb" target="_blank" rel="external">here</a>.</p>
<p>Using <code>ruby add_assertions_to_check_zap_result.rb</code> to run and check the result.</p>
</li>
<li><p>Now we can trigger this script in any CI using command above.</p>
</li>
</ol>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CI/">CI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Quick-Start/">Quick-Start</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Security/">Security</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ZAP/">ZAP</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Qucik_Start_For_ServerSpec_and_TestInfra_also_comparison_of_them" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/01/Qucik_Start_For_ServerSpec_and_TestInfra_also_comparison_of_them/">Quick start for ServerSpec and Testinfra, also comparison of them</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/09/01/Qucik_Start_For_ServerSpec_and_TestInfra_also_comparison_of_them/" class="article-date">
  <time datetime="2017-08-31T14:00:00.000Z" itemprop="datePublished">2017-09-01</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="ServerSpec-is-to-check-servers-are-configured-correctly-through-their-actual-state-using-RSpec-tests-Testinfra-is-kind-of-a-Serverspec-equivalent-in-Python-and-based-on-Pytest"><a href="#ServerSpec-is-to-check-servers-are-configured-correctly-through-their-actual-state-using-RSpec-tests-Testinfra-is-kind-of-a-Serverspec-equivalent-in-Python-and-based-on-Pytest" class="headerlink" title="ServerSpec is to check servers are configured correctly through their actual state using RSpec tests. Testinfra is kind of a Serverspec equivalent in Python and based on Pytest."></a>ServerSpec is to check servers are configured correctly through their actual state using RSpec tests. Testinfra is kind of a Serverspec equivalent in Python and based on Pytest.</h5><h3 id="Prerequisite"><a href="#Prerequisite" class="headerlink" title="Prerequisite:"></a>Prerequisite:</h3><ol>
<li><p>RVM, Ruby and rubygems are installed.</p>
</li>
<li><p>Python and pip are installed.</p>
</li>
<li><p>We would expect to run Testinfra and ServerSpec against the server rather than our local machine, so we may need to tweak a little bit by connecting the server with ssh key.</p>
<ul>
<li>Generate ssh key: <code>ssh-keygen -t rsa</code></li>
<li>Copy ssh public key to server: <code>ssh-copy-id -i ~/.ssh/id_rsa.pub username@server</code></li>
<li><p>Add following lines to ~/.ssh/config.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Host<span class="built_in"> server</span></div><div class="line"> <span class="built_in"> User </span>username</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h3 id="Get-Started-for-ServerSpec"><a href="#Get-Started-for-ServerSpec" class="headerlink" title="Get Started for ServerSpec:"></a>Get Started for ServerSpec:</h3><ol>
<li><p>Install ServerSpec.</p>
<p><code>gem install serverspec</code></p>
</li>
<li><p>Initial ServerSpec folder with basic settings. Please note the server will be set in this step.</p>
<p><code>serverspec-init</code></p>
</li>
<li><p>Write and run the ServerSpec script according to its <a href="http://serverspec.org/resource_types.html" target="_blank" rel="external">API document</a>.</p>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/ServerSpec.zip" target="_blank" rel="external">here</a>.</p>
<p>Using <code>rake spec</code> under the test folder to run and check the result.</p>
</li>
<li><p>To run specific test rather than the entire test suite.</p>
<p> Using <code>rake spec spec/host_server/sample_spec.rb</code> under the test folder to run and check the result.</p>
</li>
<li><p>To generate a html file as the test result, we can add <code>t.rspec_opts = &#39;--format html --out reports/rspec_results.html&#39;</code> in the Rakefile when new the Rake task. e.g.</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">require 'rake'</div><div class="line">require 'rspec/core/rake_task'</div><div class="line"></div><div class="line">task :spec    =&gt; 'spec:all'</div><div class="line">task :default =&gt; :spec</div><div class="line"></div><div class="line">namespace :spec do</div><div class="line">  targets = []</div><div class="line">  Dir.glob('./spec/*').each do |dir|</div><div class="line">    next unless File.directory?(dir)</div><div class="line">    target = File.basename(dir)</div><div class="line">    target = "_#&#123;target&#125;" if target == "default"</div><div class="line">    targets &lt;&lt; target</div><div class="line">  end</div><div class="line"></div><div class="line">  task :all     =&gt; targets</div><div class="line">  task :default =&gt; :all</div><div class="line"></div><div class="line">  targets.each do |target|</div><div class="line">    original_target = target == "_default" ? target[1..-1] : target</div><div class="line">    desc "Run serverspec tests to #&#123;original_target&#125;"</div><div class="line">    RSpec::Core::RakeTask.new(target.to_sym) do |t|</div><div class="line">      ENV['TARGET_HOST'] = original_target</div><div class="line"><span class="addition">+     t.rspec_opts = '--format html --out reports/test_results.html'</span></div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">end</div></pre></td></tr></table></figure>
<p>And it will generate the test result named “test_results.html” under “reports” folder every time the test runs.</p>
</li>
</ol>
<h3 id="Get-Started-for-Testinfra"><a href="#Get-Started-for-Testinfra" class="headerlink" title="Get Started for Testinfra:"></a>Get Started for Testinfra:</h3><ol>
<li><p>Install Testinfra and Paramiko.</p>
<p><code>pip install testinfra</code><br><code>pip install paramiko</code></p>
</li>
<li><p>Write and run the Testinfra script according to its <a href="http://testinfra.readthedocs.io/en/latest/modules.html" target="_blank" rel="external">API document</a>.</p>
<p>You can reference the script  <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/testinfra_test.py" target="_blank" rel="external">here</a>.</p>
<p>Using <code>testinfra testinfra_test.py</code> to run and check the result.</p>
</li>
<li><p>Some useful arguments we can use to make the test result more clear.</p>
<p>Instead of using <code>testinfra testinfra_test.py</code> directly, we can add some arguments, such as <code>-q</code>, <code>-s</code>, <code>--disable-warnings</code> and <code>--junit-xml</code>.</p>
<ul>
<li>The argument <code>-q</code> will run Testinfra in quiet mode, with less info exposed</li>
<li>The argument <code>-s</code> will let Testinfra capture No pre-test info</li>
<li>The argument <code>--disable-warnings</code> will disable warnings during Testinfra runs</li>
<li>The argument <code>--junit-xml</code> will export Testinfra test result into a xml file</li>
</ul>
<p>After adding those arguments, the command should be look like <code>testinfra -q -s --disable-warnings testinfra_test.py --junit-xml=report.xml</code></p>
</li>
<li><p>Now we can run Testinfra against the server using <code>testinfra -q -s --disable-warnings --ssh-config=/Path/to/ssh/config --hosts=server testinfra_test.py --junit-xml=report.xml</code>.</p>
</li>
</ol>
<h3 id="Comparison-between-ServerSpec-and-Testinfra"><a href="#Comparison-between-ServerSpec-and-Testinfra" class="headerlink" title="Comparison between ServerSpec and Testinfra:"></a>Comparison between ServerSpec and Testinfra:</h3><h5 id="Advantages-of-ServerSpec"><a href="#Advantages-of-ServerSpec" class="headerlink" title="Advantages of ServerSpec"></a>Advantages of ServerSpec</h5><ul>
<li><p>More documents and community support (compared to Testinfra);</p>
</li>
<li><p>The scripts, test results and reports are more readable (Testinfra is based on Pytest, and can only export report to XML not JSON);</p>
</li>
<li><p>Although Testinfra support “sysctl” and it runs successfully on the server, the command in script can’t run, and prompts error “bash: sysctl: command not found”; may also occurs to other commands/resources (potential risk);</p>
</li>
<li><p>ServerSpec can support more resources and attributes for resources than Testinfra.</p>
</li>
</ul>
<h5 id="Advantages-of-Testinfra"><a href="#Advantages-of-Testinfra" class="headerlink" title="Advantages of Testinfra"></a>Advantages of Testinfra</h5><ul>
<li><p>Can support most common resources, such as Docker, File, Group, Service, Socket and etc (equivalent to ServerSpec);</p>
</li>
<li><p>Can show the actual value when validating the permission but failed, so the debug will be quicker.</p>
</li>
</ul>
<h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h4><p>  If you can only choose Python as your programming language, you have to use Testinfra; otherwise, I recommend ServerSpec because of the benefits it can bring.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Comparison/">Comparison</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Infrastructure-Testing/">Infrastructure Testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Quick-Start/">Quick-Start</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ServerSpec/">ServerSpec</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Testinfra/">Testinfra</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Qucik_Start_For_Docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/18/Qucik_Start_For_Docker/">Quick Start for Docker</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/07/18/Qucik_Start_For_Docker/" class="article-date">
  <time datetime="2017-07-17T14:00:00.000Z" itemprop="datePublished">2017-07-18</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>  Download from <a href="https://www.docker.com/docker-mac" target="_blank" rel="external">https://www.docker.com/docker-mac</a></p>
<h3 id="Register-a-Docker-account"><a href="#Register-a-Docker-account" class="headerlink" title="Register a Docker account"></a>Register a Docker account</h3><p>  Register on <a href="https://www.docker.com/" target="_blank" rel="external">https://www.docker.com/</a></p>
<h3 id="Check-Docker-availability"><a href="#Check-Docker-availability" class="headerlink" title="Check Docker availability"></a>Check Docker availability</h3><p>  Run following commands in Terminal<br>  <code>docker -v</code><br>  <code>docker -info</code></p>
<h3 id="Pull-a-Docker-image-e-g-“Ruby”"><a href="#Pull-a-Docker-image-e-g-“Ruby”" class="headerlink" title="Pull a Docker image. e.g. “Ruby”"></a>Pull a Docker image. e.g. “Ruby”</h3><p>  <code>docker pull ruby</code></p>
<h3 id="Check-the-ruby-version-in-Docker-image-“Ruby”"><a href="#Check-the-ruby-version-in-Docker-image-“Ruby”" class="headerlink" title="Check the ruby version in Docker image “Ruby”"></a>Check the ruby version in Docker image “Ruby”</h3><p>  <code>docker run ruby ruby -v</code></p>
<h3 id="Run-Docker-image-at-background-and-with-an-alias-e-g-“trail”"><a href="#Run-Docker-image-at-background-and-with-an-alias-e-g-“trail”" class="headerlink" title="Run Docker image at background and with an alias, e.g. “trail”"></a>Run Docker image at background and with an alias, e.g. “trail”</h3><p>  <code>docker run -idt --name=trial ruby</code></p>
<h4 id="Check-all-the-running-Docker-images"><a href="#Check-all-the-running-Docker-images" class="headerlink" title="Check all the running Docker images"></a>Check all the running Docker images</h4><p>  <code>docker ps</code></p>
<h4 id="Attach-to-the-running-Docker-image-and-execute-commands-in-it"><a href="#Attach-to-the-running-Docker-image-and-execute-commands-in-it" class="headerlink" title="Attach to the running Docker image and execute commands in it"></a>Attach to the running Docker image and execute commands in it</h4><p>  You can use <code>docker attach trial</code><br>  But it’s better to use <code>docker exec -i -t trial sh</code></p>
<p><strong>Reference</strong><br><a href="https://yeasy.gitbooks.io/docker_practice/" target="_blank" rel="external">Docker — 从入门到实践</a></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Quick-Start/">Quick-Start</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Quick_Start_For_Mocha_Chai_SuperTest_In_API_Testing_With_Tips_And_Mock_Server_Moco" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/14/Quick_Start_For_Mocha_Chai_SuperTest_In_API_Testing_With_Tips_And_Mock_Server_Moco/">Quick start for Mocha + Chai + SuperTest in API Testing with Mock Server (moco) and Tips</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/07/14/Quick_Start_For_Mocha_Chai_SuperTest_In_API_Testing_With_Tips_And_Mock_Server_Moco/" class="article-date">
  <time datetime="2017-07-13T14:00:00.000Z" itemprop="datePublished">2017-07-14</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="There-are-many-combinations-to-test-APIs-but-here-we-choose-a-commonly-used-combination-for-demonstration-the-rests-will-be-pretty-much-the-same-or-likely-And-we-will-use-moco-to-quickly-simulate-a-server"><a href="#There-are-many-combinations-to-test-APIs-but-here-we-choose-a-commonly-used-combination-for-demonstration-the-rests-will-be-pretty-much-the-same-or-likely-And-we-will-use-moco-to-quickly-simulate-a-server" class="headerlink" title="There are many combinations to test APIs, but here we choose a commonly used combination for demonstration, the rests will be pretty much the same or likely. And we will use moco to quickly simulate a server."></a>There are many combinations to test APIs, but here we choose a commonly used combination for demonstration, the rests will be pretty much the same or likely. And we will use moco to quickly simulate a server.</h5><h3 id="Environment-Settings"><a href="#Environment-Settings" class="headerlink" title="Environment Settings:"></a>Environment Settings:</h3><ol>
<li><p>Install Homebrew</p>
<p><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></p>
</li>
<li><p>Install NodeJS</p>
<p><code>brew install node</code></p>
</li>
<li><p>Install Mocha, Chai, SuperTest, Exoress and Body-Parser</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> -g mocha</div><div class="line">npm <span class="keyword">install</span> chai</div><div class="line">npm <span class="keyword">install</span> supertest</div><div class="line">npm <span class="keyword">install</span> express</div><div class="line">npm <span class="keyword">install</span> <span class="keyword">body</span>-parser</div></pre></td></tr></table></figure>
</li>
<li><p>Download the moco standalone file from <a href="http://central.maven.org/maven2/com/github/dreamhead/moco-runner/0.11.1/moco-runner-0.11.1-standalone.jar" target="_blank" rel="external">Github</a></p>
</li>
<li><p>Since Mocha will only run scripts under “test” folder, so we have to create a folder named “test”.</p>
</li>
</ol>
<h3 id="Start-a-simple-server-and-test-on-it"><a href="#Start-a-simple-server-and-test-on-it" class="headerlink" title="Start a simple server and test on it:"></a>Start a simple server and test on it:</h3><ol>
<li><p>Create a json file named “user1.json”, and add following content to it:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"200"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p><em>Please note: we only define the HTTP status code here for now.</em></p>
</li>
<li><p>Start the Mock server using the command when under the “test” folder:</p>
<p><code>java -jar moco-runner-0.11.1-standalone.jar http -p 3000 -c user1.json</code></p>
<p>And you should see following lines in your Terminal:</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">10 </span>Jul <span class="number">2017</span> <span class="number">16</span>:<span class="number">17</span>:<span class="number">43</span> [main] INFO  Server is started at <span class="number">3000</span></div><div class="line"><span class="symbol">10 </span>Jul <span class="number">2017</span> <span class="number">16</span>:<span class="number">17</span>:<span class="number">43</span> [main] INFO  Shutdown port is <span class="number">56123</span></div><div class="line"><span class="symbol">10 </span>Jul <span class="number">2017</span> <span class="number">16</span>:<span class="number">17</span>:<span class="number">45</span> [nioEventLoopGroup-<span class="number">3</span>-<span class="number">2</span>] INFO  Request received:</div></pre></td></tr></table></figure>
</li>
<li><p>You can open the URL <a href="http://localhost:3000/" target="_blank" rel="external">http://localhost:3000/</a> in browser to check the response of the API, but currently since we havn’t set and response value except the status code, so you won’t see anything in the browser.</p>
</li>
<li><p>Create a script file named “user1_test.js”, and add following to it:</p>
<p>1) Add the alias to shorten the names for requiring libs:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> should = <span class="built_in">require</span>(<span class="string">'chai'</span>).should(),</div><div class="line">expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect,</div><div class="line">supertest = <span class="built_in">require</span>(<span class="string">'supertest'</span>),</div></pre></td></tr></table></figure>
<p>2) Setup the URL we want to test against:</p>
<p><code>api = supertest(&#39;http://localhost:3000&#39;);</code></p>
<p>3) Define a function to describe the feature we want to test:</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'User'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>4) Define a detailed test step to execute the test script, by adding it in the content of function above:</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">it('should return a response with HTTP code <span class="number">200</span>', function(<span class="name">done</span>) &#123;</div><div class="line">  api.get('').expect(<span class="number">200</span>, done)<span class="comment">;</span></div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
</li>
<li><p>Run the test to check the result by using:</p>
<p><code>mocha</code> or <code>mocha user1_test.js</code></p>
<p>And you should see the result like:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  ✓ should return <span class="selector-tag">a</span> response with HTTP <span class="selector-tag">code</span> <span class="number">200</span></div><div class="line"></div><div class="line"><span class="number">1</span> passing (<span class="number">28ms</span>)</div></pre></td></tr></table></figure>
<p>Great! It works.</p>
</li>
<li><p>Now, let’s make sure it works as expected by change the expected HTTP code to 404, and run it again. You should see the following:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  1) should return a response with HTTP code 200</div><div class="line"></div><div class="line">0 passing (32ms)</div><div class="line">1 failing</div><div class="line"></div><div class="line">1)<span class="built_in"> User </span>should return a response with HTTP code 200:</div><div class="line">   Error: expected 404 <span class="string">"Not Found"</span>, got 200 <span class="string">"OK"</span></div></pre></td></tr></table></figure>
<p>Awesome! It means the test really works. Now, revert the change.</p>
</li>
<li><p>It’s time to add more parameters to make it a little complex.</p>
<p>1) Add the formatter of HTTP request header in test script, and change the line of API test to following:</p>
<p><code>api.get(&#39;&#39;).set(&#39;Accept&#39;, &#39;application/json&#39;).expect(200, done);</code></p>
<p>2) Change the response of server to point to a specific URL, by adding the URI above the HTTP status code in “user1.json”, and the entire file should looks like:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"request"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"uri"</span> : <span class="string">"/users/1"</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"200"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p><em>Please note: don’t bother to restart the Mock Server. Once you save the json file with correct format moco provided, it will restart itself automatically. But if you save with any error, you have to fix it before start it, otherwise it won’t response correctly. For detailed moco usage and API docuemnts, please refer to the Documents section on <a href="https://github.com/dreamhead/moco" target="_blank" rel="external">moco Github page</a>.</em></p>
<p>3) Now, it’s time to change the test script accordingly. We need to change the line of API test to following:</p>
<p><code>api.get(&#39;/users/1&#39;).set(&#39;Accept&#39;, &#39;application/json&#39;).expect(200, done);</code></p>
<p>4) Let’s run the test script again, you should see the test pass:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">✓ should return a response with HTTP code <span class="number">200</span> (<span class="number">177</span>ms)</div><div class="line"></div><div class="line"><span class="number">1</span> passing (<span class="number">186</span>ms)</div></pre></td></tr></table></figure>
<p>5) We can also add some text response into API response, like following:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"request"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"uri"</span> : <span class="string">"/users/1"</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"200"</span>,</div><div class="line">      <span class="attr">"json"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"text"</span>: <span class="string">"Not Empty"</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>6) Then change the test script correspondingly:</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">it('should return a response with HTTP code <span class="number">200</span> and the response text should be <span class="string">"Not Empty"</span>', function(<span class="name">done</span>) &#123;</div><div class="line">  api.get('/users/1').set('Accept', 'application/json').expect(<span class="number">200</span>).end(<span class="name">function</span>(<span class="name">err</span>,res)&#123;</div><div class="line">    expect(<span class="name">res</span>.body).to.have.property(<span class="string">"text"</span>)<span class="comment">;</span></div><div class="line">    expect(<span class="name">res</span>.body.text).to.equal(<span class="string">"Not Empty"</span>)<span class="comment">;</span></div><div class="line">    done(<span class="name">err</span>)<span class="comment">;</span></div><div class="line">  &#125;)<span class="comment">;</span></div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>The test result should show “Pass”.</p>
<p>7) What if we change the expected HTTP status code ot the expected response text? Let’s try.</p>
<p>After change the expected HTTP status code to 500, once the test run, the result will be:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  <span class="number">1</span>) should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span> <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Not Empty"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">44</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span> <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Not Empty"</span>:</div><div class="line">   Error: expected <span class="number">500</span> <span class="string">"Internal Server Error"</span>, got <span class="number">200</span> <span class="string">"OK"</span></div></pre></td></tr></table></figure>
<p>Revert the change and change the expected response text to “Empty”, once the test run, the result will be:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  <span class="number">1</span>) should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span> <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Not Empty"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">46</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span> <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Not Empty"</span>:</div><div class="line"></div><div class="line">    Uncaught AssertionError: expected <span class="string">'Not Empty'</span> <span class="built_in">to</span> equal <span class="string">'Empty'</span></div><div class="line">    + expected - actual</div><div class="line"></div><div class="line">    -Not Empty</div><div class="line">    +Empty</div></pre></td></tr></table></figure>
<p> Don’t forget to revert the change.</p>
<p>8) The test script works as expected, so next, we will make it more complex.</p>
</li>
</ol>
<h3 id="Make-the-server-more-complex-and-of-course-test-against-it"><a href="#Make-the-server-more-complex-and-of-course-test-against-it" class="headerlink" title="Make the server more complex and of course, test against it:"></a>Make the server more complex and of course, test against it:</h3><ol>
<li><p>Append the API response to only respond to specific request, change the API response to:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"request"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"uri"</span> : <span class="string">"/users/1"</span>,</div><div class="line">      <span class="attr">"json"</span>: &#123;</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Yale"</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"200"</span>,</div><div class="line">      <span class="attr">"json"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"gender"</span>: <span class="string">"Male"</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
</li>
<li><p>Change the test script to reflect the changes:</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">it('should return a response with HTTP code <span class="number">200</span>, and the response text should be <span class="string">"Male"</span> if request the gender of <span class="string">"Yale"</span> as <span class="string">"name"</span>', function(<span class="name">done</span>) &#123;</div><div class="line">  api.get('/users/1').set('Accept', 'application/json').send(&#123;name:<span class="string">"Yale"</span>&#125;).expect(<span class="number">200</span>).end(<span class="name">function</span>(<span class="name">err</span>,res)&#123;</div><div class="line">    expect(<span class="name">res</span>.body).to.have.property(<span class="string">"gender"</span>)<span class="comment">;</span></div><div class="line">    expect(<span class="name">res</span>.body.gender).to.equal(<span class="string">"Male"</span>)<span class="comment">;</span></div><div class="line">    done(<span class="name">err</span>)<span class="comment">;</span></div><div class="line">  &#125;)<span class="comment">;</span></div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
</li>
<li><p>Once run the test script, it will Pass.</p>
</li>
<li><p>If we change the value in the request, like change “Yale” to “Yong”, once test script runs, it will show:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">    <span class="number">1</span>) should <span class="literal">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="built_in">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line">  <span class="number">0</span> passing (<span class="number">47</span>ms)</div><div class="line">  <span class="number">1</span> failing</div><div class="line"></div><div class="line">  <span class="number">1</span>) User should <span class="literal">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="built_in">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span>:</div><div class="line">     Uncaught AssertionError: expected &#123;&#125; <span class="keyword">to</span> have <span class="keyword">property</span> 'gender'</div></pre></td></tr></table></figure>
</li>
<li><p>If we change the value in the request, like change the 2 “gender” to “sex”, once test script runs, it will show:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  <span class="number">1</span>) should <span class="literal">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="built_in">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">39</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="built_in">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span>:</div><div class="line">   Uncaught AssertionError: expected &#123;&#125; <span class="keyword">to</span> have <span class="keyword">property</span> 'sex'</div></pre></td></tr></table></figure>
</li>
<li><p>If we change the value in the request, like change “Male” to “Man”, once test script runs, it will show:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  <span class="number">1</span>) should <span class="literal">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="built_in">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">44</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="built_in">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span>:</div><div class="line">   Uncaught AssertionError: expected &#123;&#125; <span class="keyword">to</span> have <span class="keyword">property</span> 'gender'</div></pre></td></tr></table></figure>
</li>
<li><p>You may notice that in the test script, we still use GET method rather than PUT or POST, but we still can let the test Pass. Now, let’s strict it. In the API response, we need to change it to following:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"request"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"uri"</span> : <span class="string">"/users/1"</span>,</div><div class="line">      <span class="attr">"method"</span>: <span class="string">"get"</span>,</div><div class="line">      <span class="attr">"json"</span>: &#123;</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Yale"</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"500"</span>,</div><div class="line">      <span class="attr">"json"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"gender"</span>: <span class="string">"Male"</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"request"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"uri"</span> : <span class="string">"/users/1"</span>,</div><div class="line">      <span class="attr">"method"</span>: <span class="string">"put"</span>,</div><div class="line">      <span class="attr">"json"</span>: &#123;</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Yale"</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"200"</span>,</div><div class="line">      <span class="attr">"json"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"gender"</span>: <span class="string">"Male"</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
</li>
<li><p>Simply change the HTTP method to “put” in test script and check the result:</p>
<p>In the test script:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">api</span><span class="selector-class">.put</span>(<span class="string">'/users/1'</span>)<span class="selector-class">.set</span>(<span class="string">'Accept'</span>, <span class="string">'application/json'</span>)<span class="selector-class">.send</span>(&#123;<span class="attribute">name</span>:<span class="string">"Yale"</span>&#125;)<span class="selector-class">.expect</span>(<span class="number">200</span>)<span class="selector-class">.end</span>(function(err,res)&#123;</div><div class="line">  <span class="selector-tag">expect</span>(res.body)<span class="selector-class">.to</span><span class="selector-class">.have</span><span class="selector-class">.property</span>(<span class="string">"gender"</span>);</div><div class="line">  <span class="selector-tag">expect</span>(res.body.gender)<span class="selector-class">.to</span><span class="selector-class">.equal</span>(<span class="string">"Male"</span>);</div><div class="line">  <span class="selector-tag">done</span>(err);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>And the test result:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  ✓ should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line"><span class="number">1</span> passing (<span class="number">41</span>ms)</div></pre></td></tr></table></figure>
</li>
<li><p>Let’s see what if we change the HTTP method to “get” again in test script and check the result:</p>
<p>In the test script:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">api</span><span class="selector-class">.get</span>(<span class="string">'/users/1'</span>)<span class="selector-class">.set</span>(<span class="string">'Accept'</span>, <span class="string">'application/json'</span>)<span class="selector-class">.send</span>(&#123;<span class="attribute">name</span>:<span class="string">"Yale"</span>&#125;)<span class="selector-class">.expect</span>(<span class="number">200</span>)<span class="selector-class">.end</span>(function(err,res)&#123;</div><div class="line">  <span class="selector-tag">expect</span>(res.body)<span class="selector-class">.to</span><span class="selector-class">.have</span><span class="selector-class">.property</span>(<span class="string">"gender"</span>);</div><div class="line">  <span class="selector-tag">expect</span>(res.body.gender)<span class="selector-class">.to</span><span class="selector-class">.equal</span>(<span class="string">"Male"</span>);</div><div class="line">  <span class="selector-tag">done</span>(err);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>And the test result:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">  <span class="number">1</span>) should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">39</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span>:</div><div class="line">   Error: expected <span class="number">200</span> <span class="string">"OK"</span>, got <span class="number">500</span> <span class="string">"Internal Server Error"</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Final-stage-more-advanced-usage"><a href="#Final-stage-more-advanced-usage" class="headerlink" title="Final stage - more advanced usage:"></a>Final stage - more advanced usage:</h3><ol>
<li><p>If we want to add more API responses, do we need to add them into one json file? Certainly not, let’s see how we can do that.</p>
<p>1) Create another json file named “user2”, and add following content to it:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">  <span class="attr">"request"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"uri"</span> : <span class="string">"/users/2"</span>,</div><div class="line">      <span class="attr">"method"</span>: <span class="string">"post"</span>,</div><div class="line">      <span class="attr">"json"</span>: &#123;</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Yong"</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"response"</span> :</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"status"</span> : <span class="string">"500"</span>,</div><div class="line">      <span class="attr">"text"</span> : <span class="string">"Internal Server Error"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>2) Create another js file named “user2_test.js”, and add following into its content:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">var should = <span class="built_in">require</span>(<span class="string">'chai'</span>).should(),</div><div class="line">  expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect,</div><div class="line">  supertest = <span class="built_in">require</span>(<span class="string">'supertest'</span>),</div><div class="line">  api = supertest(<span class="string">'http://localhost:3000'</span>);</div><div class="line">describe(<span class="string">'User'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</div><div class="line">  it(<span class="string">'should return a response with HTTP code 500 and its content if request the gender of "Yong" as "name"'</span>, <span class="function"><span class="keyword">function</span><span class="params">(done)</span></span> &#123;</div><div class="line">    api.post(<span class="string">'/users/2'</span>).set(<span class="string">'Accept'</span>, <span class="string">'application/json'</span>).send(&#123;name:<span class="string">"Yong"</span>&#125;).expect(<span class="number">500</span>).<span class="keyword">end</span>(<span class="function"><span class="keyword">function</span><span class="params">(err,res)</span></span>&#123;</div><div class="line">      <span class="keyword">if</span> (err) <span class="keyword">return</span> done(err);</div><div class="line">      expect(res.<span class="built_in">error</span>.text).to.equal(<span class="string">"Internal Server Error"</span>);</div><div class="line">      done(err);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>3) Once you run the test script, it will show:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">    ✓ should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yong"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line">  <span class="number">1</span> passing (<span class="number">41</span>ms)</div></pre></td></tr></table></figure>
<p>4) If we only change the expected HTTP status code in the test script to 404, the result will be:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line"><span class="number">1</span>) should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yong"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">45</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yong"</span> <span class="keyword">as</span> <span class="string">"name"</span>:</div><div class="line">  Error: expected <span class="number">404</span> <span class="string">"Not Found"</span>, got <span class="number">500</span> <span class="string">"Internal Server Error"</span></div></pre></td></tr></table></figure>
<p>5) And if we only change the expected response message to “Not Found”, the result will be:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line"><span class="number">1</span>) should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yong"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line"><span class="number">0</span> passing (<span class="number">43</span>ms)</div><div class="line"><span class="number">1</span> failing</div><div class="line"></div><div class="line"><span class="number">1</span>) User should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yong"</span> <span class="keyword">as</span> <span class="string">"name"</span>:</div><div class="line"></div><div class="line">    Uncaught AssertionError: expected <span class="string">'Internal Server Error'</span> <span class="built_in">to</span> equal <span class="string">'Not Found'</span></div><div class="line">    + expected - actual</div><div class="line"></div><div class="line">    -Internal Server Error</div><div class="line">    +Not Found</div></pre></td></tr></table></figure>
<p>6) Revert all changes back again, and create another json file named “combined.json”, and add following:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"include"</span>: <span class="string">"user1.json"</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"include"</span>: <span class="string">"user2.json"</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p> And start the Mock Server using <code>java -jar moco-runner-0.11.1-standalone.jar http -p 3000 -g combined.json</code></p>
<p>7) Use Mocha to run all the test scripts:</p>
<p><code>mocha *.js</code></p>
<p>And you should see:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">User</div><div class="line">    ✓ should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> <span class="keyword">the</span> response <span class="keyword">text</span> should be <span class="string">"Male"</span> <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yale"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line">  User</div><div class="line">    ✓ should <span class="literal">return</span> <span class="keyword">a</span> response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request <span class="keyword">the</span> gender <span class="keyword">of</span> <span class="string">"Yong"</span> <span class="keyword">as</span> <span class="string">"name"</span></div><div class="line"></div><div class="line">  <span class="number">2</span> passing (<span class="number">49</span>ms)</div></pre></td></tr></table></figure>
<p>8) If you want to run a single test script to test all steps, you can create a js file named “users_test.js”, and add following content:</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">var should = require(<span class="symbol">'chai</span>').should(),</div><div class="line">  expect = require(<span class="symbol">'chai</span>').expect,</div><div class="line">  supertest = require(<span class="symbol">'supertest</span>'),</div><div class="line">  api = supertest(<span class="symbol">'http</span>://localhost:<span class="number">3000</span>');</div><div class="line">describe(<span class="symbol">'User</span>', <span class="keyword">function</span>() &#123;</div><div class="line">  it(<span class="symbol">'should</span> <span class="keyword">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">200</span>, <span class="keyword">and</span> the response text should be <span class="string">"Male"</span> <span class="keyword">if</span> request the gender <span class="keyword">of</span> <span class="string">"Yale"</span> as <span class="string">"name"</span>', <span class="keyword">function</span>(done) &#123;</div><div class="line">    api.put('/users/<span class="number">1</span>').set(<span class="symbol">'Accept</span>', <span class="symbol">'application</span>/json').send(&#123;name:<span class="string">"Yale"</span>&#125;).expect(<span class="number">200</span>).<span class="keyword">end</span>(<span class="keyword">function</span>(err,res)&#123;</div><div class="line">      expect(res.<span class="keyword">body</span>).to.have.property(<span class="string">"gender"</span>);</div><div class="line">      expect(res.<span class="keyword">body</span>.gender).to.equal(<span class="string">"Male"</span>);</div><div class="line">      done(err);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="symbol">'should</span> <span class="keyword">return</span> a response <span class="keyword">with</span> HTTP code <span class="number">500</span> <span class="keyword">and</span> its content <span class="keyword">if</span> request the gender <span class="keyword">of</span> <span class="string">"Yong"</span> as <span class="string">"name"</span>', <span class="keyword">function</span>(done) &#123;</div><div class="line">    api.post('/users/<span class="number">2</span>').set(<span class="symbol">'Accept</span>', <span class="symbol">'application</span>/json').send(&#123;name:<span class="string">"Yong"</span>&#125;).expect(<span class="number">500</span>).<span class="keyword">end</span>(<span class="keyword">function</span>(err,res)&#123;</div><div class="line">      <span class="keyword">if</span> (err) <span class="keyword">return</span> done(err);</div><div class="line">      expect(res.error.text).to.equal(<span class="string">"Internal Server Error"</span>);</div><div class="line">      done(err);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>9) Run the test using <code>mocha users_test.js</code>, it will show the same result as above.</p>
</li>
</ol>
<h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips:"></a>Tips:</h3><ol>
<li>If you want to test against OAuth protocol, you need to change SuperTest to unirest. Thanks to <a href="https://qaseven.github.io/" target="_blank" rel="external">QiLei</a>.</li>
</ol>
<h3 id="Later-on"><a href="#Later-on" class="headerlink" title="Later on:"></a>Later on:</h3><p>Since you already can run your test scripts smoothly through command line, you can simply add them to CI tools, such as Jenkins and such.</p>
<p>Have fun!</p>
<p><strong><em>You can find all the test scripts from <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/API_Test_Mocha_Chai_SuperTest.zip" target="_blank" rel="external">here</a>.</em></strong></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/API/">API</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Automation/">Automation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Chai/">Chai</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mocha/">Mocha</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mock-Server/">Mock Server</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Quick-Start/">Quick-Start</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Supertest/">Supertest</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/moco/">moco</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Quick_Start_For_Appium_iOS_And_Android" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/10/Quick_Start_For_Appium_iOS_And_Android/">Quick start for appium (iOS and Android)</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/07/10/Quick_Start_For_Appium_iOS_And_Android/" class="article-date">
  <time datetime="2017-07-09T14:00:00.000Z" itemprop="datePublished">2017-07-10</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="There-are-many-changes-compared-to-the-early-version-of-appium-so-I-would-like-to-start-from-scratch-to-build-a-simple-testing-script-for-appium-For-further-reading-about-how-to-apply-Page-Object-and-BDD-to-appium-you-can-read-my-previous-article-Cookbook-for-appium-and-BDD-with-PageObject"><a href="#There-are-many-changes-compared-to-the-early-version-of-appium-so-I-would-like-to-start-from-scratch-to-build-a-simple-testing-script-for-appium-For-further-reading-about-how-to-apply-Page-Object-and-BDD-to-appium-you-can-read-my-previous-article-Cookbook-for-appium-and-BDD-with-PageObject" class="headerlink" title="There are many changes compared to the early version of appium, so I would like to start from scratch to build a simple testing script for appium. For further reading about how to apply Page Object and BDD to appium, you can read my previous article Cookbook for appium and BDD with PageObject."></a>There are many changes compared to the early version of appium, so I would like to start from scratch to build a simple testing script for appium. For further reading about how to apply Page Object and BDD to appium, you can read my previous article <a href="http://hy1984427.github.io/appium/">Cookbook for appium</a> and <a href="http://hy1984427.github.io/BDD-with-PageObject/">BDD with PageObject</a>.</h5><h3 id="Environment-Settings"><a href="#Environment-Settings" class="headerlink" title="Environment Settings:"></a>Environment Settings:</h3><ol>
<li><p>Install XCode and its command line tool.</p>
<p>To install XCode command line tool, you can use the following command in Terminal:</p>
<p><code>xcode-select --install</code></p>
<p>And download the OS versions you want to work with.</p>
</li>
<li><p>It’s better to choose Ruby to write the test script as it’s easy to get familiar with. And to install/upgrade it, we can use following commands:</p>
<p>1) Install Homebrew</p>
<p><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></p>
<p>2) Install Ruby</p>
<p><code>brew install ruby</code></p>
</li>
<li><p>Install appium and related gems:</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>libimobiledevice --HEAD</div><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>node</div><div class="line">npm <span class="keyword">install </span>-g ios-deploy</div><div class="line">sudo gem <span class="keyword">install </span>xcpretty</div><div class="line">npm <span class="keyword">install </span>appium-doctor -g</div><div class="line">npm <span class="keyword">install </span>-g appium</div><div class="line">npm <span class="keyword">install </span>wd</div><div class="line">npm <span class="keyword">install </span>appium-xcuitest-driver</div><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>carthage</div><div class="line">gem <span class="keyword">install </span>--no-rdoc --no-ri <span class="keyword">bundler</span></div><div class="line">gem <span class="keyword">install </span>--no-rdoc --no-ri appium_lib</div><div class="line">gem <span class="keyword">install </span>--no-rdoc --no-ri appium_console</div></pre></td></tr></table></figure>
</li>
<li><p>Install JDK for Android:</p>
<p>Download from <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">Java SE Development Kit 8 - Downloads</a> and install.</p>
</li>
<li><p>Install Android Studio from <a href="https://developer.android.com/studio/index.html" target="_blank" rel="external">Download Android Studio and SDK Tools | Android Studio</a> and download the OS version you want to work with.</p>
</li>
<li><p>Configure the bach_profile to set environment parameters:</p>
<p>Edit your <em><code>~/.bash_profile</code></em>, if you don’t have one, just create it and add following lines to it:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="builtin-name">export</span> <span class="attribute">ANDROID_HOME</span>=/Users/$your_name/Library/Android/sdk</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ANDROID_SDK</span>=<span class="variable">$ANDROID_HOME</span></div><div class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$ANDROID_HOME/build-tools</div><div class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$ANDROID_HOME/platform-tools</div><div class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$ANDROID_HOME/tools</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=<span class="string">"`/System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/java_home`"</span></div><div class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$JAVA_HOME/bin</div><div class="line"><span class="builtin-name">export</span> PATH</div></pre></td></tr></table></figure>
</li>
<li><p>Run <em><code>appium-doctor</code></em> in Terminal to see if everything works fine. (You need to see there are all green.)</p>
</li>
</ol>
<h3 id="Generate-the-apps-to-be-tested"><a href="#Generate-the-apps-to-be-tested" class="headerlink" title="Generate the apps to be tested:"></a>Generate the apps to be tested:</h3><ol>
<li><p>Download the iOS UIKit Catalog source code from <a href="https://developer.apple.com/library/content/samplecode/UICatalog/UIKitCatalogiOSCreatingandCustomizingUIKitControls.zip" target="_blank" rel="external">UIKitCatalog</a>.</p>
<p>1) Unzip it and open the project in the Swift folder.</p>
<p>2) Build it in XCode by selecting the OS version you would like to test.</p>
<p>3) Expand the “Products” folder in the project structure, and select the app generated.</p>
<p>4) Right click it and select “Show in Finder”, and copy the app with extension as .app to your test folder for future use.</p>
</li>
<li><p>Download the “TextSwitcher” from “Import an Android code sample” in Android Studio welcome screen.</p>
<p>1) Change the “minSdkVersion” from 7 to 9 in “build.gradle (Module:Application)” and build the app.</p>
<p>2) Right click the root of project structure and select “Reveal in Finder”, and copy the app with extension as .apk in “/Users/$your_name/AndroidStudioProjects/TextSwitcher/Application/build/outputs/apk” to your test folder for future use.</p>
</li>
</ol>
<h3 id="Identify-elements-using-appium-GUI"><a href="#Identify-elements-using-appium-GUI" class="headerlink" title="Identify elements using appium GUI:"></a>Identify elements using appium GUI:</h3><ol>
<li><p>Download the appium GUI through their website;</p>
</li>
<li><p>Start appium GUI after install;</p>
</li>
<li><p>Start the server by default;</p>
</li>
<li><p>Start a new session;</p>
</li>
<li><p>Input all capabilities you want to use in “Desired Capabilities”, such as:</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">platformName   <span class="keyword">text</span>   iOS</div><div class="line">platformVersion   <span class="keyword">text</span>   <span class="number">10.2</span></div><div class="line">deviceName   <span class="keyword">text</span>   iPhone <span class="number">7</span></div><div class="line">app   <span class="keyword">text</span> /Users/$your_name/Documents/UIKitCatalog.app</div></pre></td></tr></table></figure>
<p>Above shows the basic capabilities you must pass to appium to run the app. (For Android, it’s basically the same, unless you first activity is not MainActivity so you need to set “appActivity” pointed to the right one.)</p>
</li>
<li><p>Then you can actually “Start Session”. (For Android, you need to start your emulator before this, appium won’t automatically start Android emulator like it does for iOS.)</p>
</li>
<li><p>Wait for some time, another window would popup. In this window, you should see the app’s visual and could inspect elements in it.</p>
</li>
<li><p>Once click the element on app UI in the inspector window, you can see the properties of the element shows on the right side.</p>
<p>1) Try to use id to locate element as possible.</p>
<p>2) The “Tap”, “Send Keys” and “Clear” button in the right “Selected Element” panel will simulate the corresponding action, and you will see the consequences in the app UI.</p>
<p>3) You can use “Back” on the top of this window to simulate hardware Back action, and next to it is Refresh.</p>
<p>4) The eye icon is very useful if you would like to record all your steps into a script. Any action after you click that icon will be recorded, until it’s been clicked again.</p>
<p>5) You can choose the language you want to record, and you can select to show/hide the supporting code (the code to support you start and end tests rather than the test steps), copy and delete the test codes.</p>
<p>6) The last one on the top will close this window and entire session.</p>
</li>
<li><p>With the inspector, you have recorded some script, or you have written your own code with the inspector to locate elements. The code should look like following:</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">require 'rubygems'</div><div class="line">require 'appium_lib'</div><div class="line">caps = &#123;&#125;</div><div class="line">caps[<span class="string">"platformName"</span>] = <span class="string">"iOS"</span></div><div class="line">caps[<span class="string">"platformVersion"</span>] = <span class="string">"10.2"</span></div><div class="line">caps[<span class="string">"deviceName"</span>] = <span class="string">"iPhone 7"</span></div><div class="line">caps[<span class="string">"app"</span>] = <span class="string">"/Users/$your_name/Documents/UIKitCatalog.app"</span></div><div class="line">opts = &#123;</div><div class="line"><span class="section">sauce_username: nil,</span></div><div class="line"><span class="section">server_url: "http://localhost:4723/wd/hub"</span></div><div class="line">&#125;</div><div class="line">driver = Appium::Driver.new(&#123;caps: caps, appium_lib: opts&#125;).start_driver</div><div class="line">driver.navigate.back</div><div class="line">el1 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[14]"</span>)</div><div class="line">el1.click</div><div class="line">el2 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[1]/XCUIElementTypeTextField"</span>)</div><div class="line">el2.send_keys <span class="string">"123"</span></div><div class="line">el3 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[2]/XCUIElementTypeTextField"</span>)</div><div class="line">el3.send_keys <span class="string">"456"</span></div><div class="line">driver.quit</div></pre></td></tr></table></figure>
<p>Save the script to a .sh file, such as test.sh.</p>
</li>
</ol>
<h3 id="Run-appium-test"><a href="#Run-appium-test" class="headerlink" title="Run appium test:"></a>Run appium test:</h3><ol>
<li><p>Now we can run the script through the command line (Terminal).</p>
</li>
<li><p>After we close appium GUI, we need to run appium in a Terminal tab, then open your test folder. Under the folder, run following command:</p>
<p> <code>ruby test.sh</code></p>
</li>
<li><p>You should see the simulator started and test runs.</p>
</li>
<li><p>But we DO NOT have any assertion. Let’s add some.</p>
<p>1) Install RSpec through</p>
<p><code>gem install rspec</code></p>
<p>2) Include RSpec and its matchers in the “Require” section</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">'rubygems'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'appium_lib'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'rspec'</span></div><div class="line"><span class="keyword">include</span> RSpec::Matchers</div></pre></td></tr></table></figure>
<p>3) Add assertions to the test, like:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">driver<span class="selector-class">.navigate</span><span class="selector-class">.back</span></div><div class="line">el1 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[14]"</span>)</div><div class="line">el1<span class="selector-class">.click</span></div><div class="line">el2 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[1]/XCUIElementTypeTextField"</span>)</div><div class="line">el2<span class="selector-class">.send_keys</span> <span class="string">"123"</span></div><div class="line">el2<span class="selector-class">.value</span><span class="selector-class">.should</span> == <span class="string">"123"</span></div><div class="line">el3 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[2]/XCUIElementTypeTextField"</span>)</div><div class="line">el3<span class="selector-class">.send_keys</span> <span class="string">"456"</span></div><div class="line">el3<span class="selector-class">.value</span><span class="selector-class">.should</span> == <span class="string">"456"</span></div></pre></td></tr></table></figure>
<p>4) To make sure the assertions really works, we can alter like:</p>
<p><code>el3.value.should == &quot;345&quot;</code></p>
<p>5) And run it again, it should show following in Terminal:</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">ruby</span>/<span class="title">gems</span>/2.4.0/<span class="title">gems</span>/<span class="title">rspec</span>-<span class="title">support</span>-3.6.0/<span class="title">lib</span>/<span class="title">rspec</span>/<span class="title">support</span>.<span class="title">rb</span>:87:<span class="title">in</span> `<span class="title">block</span> <span class="title">in</span> &lt;<span class="title">module</span>:<span class="title">Support</span>&gt;': <span class="title">expected</span>: "345" (<span class="title">RSpec::Expectations::ExpectationNotMetError</span>)</span></div><div class="line"><span class="symbol">got:</span> <span class="string">"456"</span> (using ==)</div></pre></td></tr></table></figure>
<p>6) Now we can revert the change, and complete the test script.</p>
<p>7) The final test script should looks like:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">require <span class="string">'rubygems'</span></div><div class="line">require <span class="string">'appium_lib'</span></div><div class="line">require <span class="string">'rspec'</span></div><div class="line">include RSpec::Matchers</div><div class="line">caps = &#123;&#125;</div><div class="line">caps[<span class="string">"platformName"</span>] = <span class="string">"iOS"</span></div><div class="line">caps[<span class="string">"platformVersion"</span>] = <span class="string">"10.2"</span></div><div class="line">caps[<span class="string">"deviceName"</span>] = <span class="string">"iPhone 7"</span></div><div class="line">caps[<span class="string">"app"</span>] = <span class="string">"/Users/yhuang/Documents/appium/UIKitCatalog.app"</span></div><div class="line">opts = &#123;</div><div class="line">sauce_username: nil,</div><div class="line">server_url: <span class="string">"http://localhost:4723/wd/hub"</span></div><div class="line">&#125;</div><div class="line">driver = Appium::Driver.new(&#123;caps: caps, appium_lib: opts&#125;)<span class="selector-class">.start_driver</span></div><div class="line">driver<span class="selector-class">.navigate</span><span class="selector-class">.back</span></div><div class="line">el1 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[14]"</span>)</div><div class="line">el1<span class="selector-class">.click</span></div><div class="line">el2 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[1]/XCUIElementTypeTextField"</span>)</div><div class="line">el2<span class="selector-class">.send_keys</span> <span class="string">"123"</span></div><div class="line">el2<span class="selector-class">.value</span><span class="selector-class">.should</span> == <span class="string">"123"</span></div><div class="line">el3 = driver.find_element(:xpath, <span class="string">"//XCUIElementTypeCell[2]/XCUIElementTypeTextField"</span>)</div><div class="line">el3<span class="selector-class">.send_keys</span> <span class="string">"456"</span></div><div class="line">el3<span class="selector-class">.value</span><span class="selector-class">.should</span> == <span class="string">"456"</span></div><div class="line">driver.quit</div></pre></td></tr></table></figure>
</li>
<li><p>Now it’s all done.</p>
</li>
</ol>
<h3 id="Please-Note"><a href="#Please-Note" class="headerlink" title="Please Note:"></a>Please Note:</h3><ol>
<li><p>This is just a sample to run test, but we actually should write it in BDD way with Page Object.</p>
</li>
<li><p>It should also be integrated with CI.</p>
</li>
<li><p>If you want to use Appium to test Android, I recommend you to use Genymotion rather than AVD, even you are using x86 kernel for AVD.</p>
</li>
<li><p>You can reference to the <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/UIKitCatalog.zip" target="_blank" rel="external">app</a> and <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/UIKitCatalog.sh" target="_blank" rel="external">script</a> for UIKitCatalog and the <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/AndroidCalculator.apk" target="_blank" rel="external">app</a> and <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/AndroidCalculator.sh" target="_blank" rel="external">script</a> for Android Calculator.</p>
</li>
</ol>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Appium/">Appium</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Automation/">Automation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Quick-Start/">Quick-Start</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Domestic_Project_Manager" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/06/Domestic_Project_Manager/">国内交付项目新手PM生存指南</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/06/06/Domestic_Project_Manager/" class="article-date">
  <time datetime="2016-06-05T14:00:00.000Z" itemprop="datePublished">2016-06-06</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Test/">Test</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong><em>长期以来一直做国外的交付项目，对于国内的项目总是很怵，因为总觉得做国内项目就需要像电视剧中一样边谈项目边喝酒应酬，而且还天天加班，所以一直以来没有机会也没有勇气接近国内项目。</em></strong></p>
<p><strong><em>但是，机缘巧合，最近在国内项目上摸爬滚打了一段时间，感觉可以把自己的经历和经验记录下来，跟大家分享一下。</em></strong></p>
<p>也许大家接触的都是国内客户，但是不同的客户会有自己独特的风格，在下文中我会按照交付项目开展的时间顺序为大家介绍它们通用的和特有的问题及经历。</p>
<h1 id="售前阶段">售前阶段</h1><p>在正式开始项目前，我们需要对<strong>项目管理的“金三角”（时间、范围和成本）</strong>有明确的认识。但是在售前阶段这些问题的答案都很模糊，需要我们逐步分析和确认。</p>
<p>一般会通过以下三个步骤来解决。</p>
<h3 id="第一步：了解背景">第一步：了解背景</h3><p>我们首先需要做的是<strong>找到这个项目机会的来源</strong>，也就向销售的同事获取尽可能多的信息，例如这个机会是哪个客户给的，他／她在客户组织架构中的位置是什么样的，他／她对我们有什么样的建议和想法，这个机会所在部门的背景情况和重视程度，这个项目现在遇到的问题和以后有可能遇到的问题，我们去谈需求时需要联系谁，联系方式是什么。</p>
<p>拿到了这些消息后，我们还可以利用现有的信息，在公司内部找和客户同一部门或者类似部门打过交道的同事<strong>了解更多的背景和技术知识</strong>，尽可能找一个在同一客户下工作过，最好是客户熟知并且对客户有影响力的同事，在洽谈需求时能一起参加，这不仅会让我们更有底气，能更准确地了解客户需求，也会让客户增加更加信任。</p>
<p>这些信息我们最好能够记录并保存下来，而且需要系统性地整理这些信息及注意事项。</p>
<p>在这一阶段我们了解的更多都是全局的内容，而在项目中我们往往忽视了从全局观出发，如何能更好地解决问题。</p>
<h3 id="第二步：拜访客户">第二步：拜访客户</h3><p>有了这些信息，下一步就是<strong>和客户约好时间，进行拜访</strong>。</p>
<p>第一次进行客户拜访，通常双方需要先进行相互介绍，我们一般也会派出项目的PM和Tech Lead参与拜访，拜访的内容主要是<strong>了解需求</strong>。但是第一次谈需求，我们需要注意更多从业务和价值角度切入，而不要陷入技术细节。这时我们往往会发现自己之前设想的和客户描述出来的差别很大。但是我们要注意，不要过于坚持自己的想法，而需要根据客户的描述，通过自己的问题一步一步地引导客户说出他们的痛点和期望，从而能使项目的目标清晰。</p>
<p>在这一阶段通常我们也要向客户展示我们的技术实力，让客户坚定选择我们的决策是正确的。采取的方式可以有针对项目相关技术的演讲或者演示。总的来说，最好把第一次拜访控制在一个小时左右，这样我们一方面得到了相关的项目知识，另一方面，为下一次会面向客户展示具体的项目相关技术实力提供了机会。</p>
<p>在有了项目业务需求和痛点之后，我们需要修正自己之前的想法和设计，根据最新的情况进行总结，并且最好得到客户的确认。</p>
<p>接着，根据这些信息，我们就可以着手进行<strong>技术架构的设计以及风险的评估</strong>，为后续的拜访明确目标，使会议更高效。之后的拜访或者会议都是一步一步的细化过程，包括确定是用什么技术栈，什么架构，客户如何与我们交付团队合作等等。不过我们需要控制每次会议以及为项目准备时间的投入，以及这一阶段持续的时间。因为持续时间长不仅会让客户感觉我们不专业，也会暗示我们不理解项目。再说，如果项目最后没有谈成，也是对于公司资源的浪费。</p>
<h3 id="第三步：合同形式">第三步：合同形式</h3><p>上面我们说的都是技术方面的，售前阶段有很重要的一点是需要了解<strong>客户想以什么样的方式和我们签合同</strong>。因为咨询和交付项目的工作方式以及交付物都是不一样的，如果我们以交付项目的形式签订合同，而以咨询的形式工作，那在项目结束时，我们会面临如何验收，如何提供交付物的问题。这也很有可能让客户在工作验收和领导汇报时陷入被动，因为实际完成的和合同上签署的内容是不一致的。</p>
<p>如果我们能够顺利解决上面所说的问题，我们就可以等着进行投标等工作了。下面我们就来看看神秘的投标阶段都会有什么意想不到的问题吧。</p>
<h1 id="投标阶段">投标阶段</h1><p>首先我们需要<strong>根据标书的要求，完成相关系统的设计</strong>。这些设计并不只是技术架构，还需要包含对于客户的理解，对于项目现状的理解，对于项目远景的理解，以及由此而产生的技术架构和实施计划。同时，我们还需要展现我们对于同一类型项目的经验和成功案例。</p>
<p>编写标书的技术方案看起来简单，只要写命题作文就可以了。</p>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Proposal_Index.png" alt="标书的大致目录"></p>
<p>图 1.1 － 标书的大致目录</p>
<p>但是，标书需要我们<strong>协同配合</strong>，尤其是需要售前同事和交付团队进行密切沟通，确保交付团队在得到客户真实意图，准确把握客户的期望和优先级的情况下，出具架构合理、充分考虑到客户需求和成本的方案。如果在投标前期给客户做过Inception，我们还需要和Inception团队全力合作，进行知识的有效传递（最好能让Inception团队来编写标书）。如果能从Inception的团队中获得例如线框图（如图1.4），用户画像，用户旅程，推荐的技术架构甚至Epic Story，对于确定项目范围和编写技术方案来说会助力很多。</p>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Wireframe.png" alt="线框图和用户旅程"></p>
<p>图 1.2 － 线框图和用户旅程</p>
<h3 id="关键点一：技术栈和技术架构">关键点一：技术栈和技术架构</h3><p><strong>在编写标书时的关键之一在于技术栈和技术架构</strong>。在我们根据客户的需求确定这两项之后，我们还需要进行架构评审，以便集思广益，减少架构设计时引入交付风险，同时也可以更好的权衡交付压力和技术卓越。我们不仅需要考虑使用什么技术来满足客户的需求，还需要考虑客户运行项目的成本，甚至客户是否需要付出很多成本招聘到合适的运维人员等。</p>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Architecture.png" alt="技术架构"></p>
<p>图 1.3 － 技术架构</p>
<h3 id="关键点二：估算工作量">关键点二：估算工作量</h3><p><strong>确定了技术栈和技术框架之后就需要对工作量进行估算了</strong>。在进行估算时我们不能按照特定的人员能力进行估算，而需要按照平均开发水平估算交付项目的人天，因为我们不能确定谁来进行开发。由于和客户签订合同通常是以人天为单位进行计算的，所以按照我们通常使用的以难易程度为点数进行估算也是可以的，不过最后也需要转换成人天。在估算出工作量之后还需要和售前同事权衡架构设计的精密性和交付周期。此外，对于有些客户，我们评估了工作量后，还需要和他们针对每一个功能的工作量进行PK，确定我们的工作量没有水分，因为我们更需要对项目业务和技术都有深入的了解。</p>
<h3 id="关键点三：确定人员计划">关键点三：确定人员计划</h3><p><strong>编写标书的另一个关键是确定人员计划</strong>，但是这一点依赖于前面两项。在确定了技术方案后，我们需要根据具体的技术需求，确定需要什么样的角色，例如使用什么技术的前后端开发，是否需要iOS／Android的开发，是否需要UX等；以及根据对于交付项目的工作量估算，确定这些人员上项目和下项目的时间，并且最好能留一点buffer，以应对需求变化和请假等不确定因素，同时还需要考虑到项目交付后一段时间的维护计划。项目的利润也是PM需要重点关注的，这也会影响到选什么样的人加入项目。由于我们通常并不会获得完全适合项目技术的人员参加项目，所以作为PM也得负责人员的培养，以达到项目的要求。</p>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Staffing_Plan.png" alt="人员计划"></p>
<p>图 1.4 － 人员计划</p>
<p>此外，我们不仅需要充分考虑以上三个方面，还需要<strong>突出我们的亮点</strong>，使客户能更直观地了解我们的价值所在。</p>
<p>在编写标书前我们就得<strong>设定好心理预期</strong>，编写标书，尤其是第一次编写标书时，通常都会有很多地方都要修改很多遍。虽然修改很累很繁琐，但是只有做好了这一步，才能让后续工作更顺利。</p>
<h2 id="讲标阶段">讲标阶段</h2><p>投标不仅包含编写标书，还包括讲标的环节。两者中间实际上还有“投标”这一活动，但是一般是由特定的同事去投标的，所以作为PM和技术人员，通常在这一阶段更关注于投标之后的讲标。</p>
<p>顾名思义，讲标就是在客户现场把投递的标书讲一遍。但实际上前后的准备工作都很多。</p>
<p>首先，我们要<strong>准备讲标标书</strong>。大家会觉得奇怪，刚才不是写好标书都投了吗？还写什么讲标标书啊？其实一般投标的纸质版标书会有150～200页的内容，而讲标时间通常都是半小时，再加上15分钟左右的问答，所以在30分钟内不可能讲完标书上的所有内容，因此我们需要对标书进行精简，并且多以图表和图片的形式进行展示。这一过程也会和编写标书一样会修改很多次。</p>
<p>其次，还需要进行讲<strong>标的演练</strong>。需要有人模仿客户，提出各种问题和挑战，让讲标的同学尽可能做好应对各种不同的听众和情况，随机应变，使整个讲标过程在控制中。同样演练也会进行多次，以使演讲技巧和临场能力得到锻炼。</p>
<p>再次，在正式讲标前，我们需要准备好电脑电源，翻页笔，显示器转接头，装有讲标文件的优盘，各种格式的讲标文件（Keynote、PPT、PDF等）等设备和资料，<strong>避免任何出错的可能</strong>。并且我们需要提前到场，如果离客户远一定要留好充足的时间，避免迟到而影响讲标效果。</p>
<p>最后，在讲标时，我们只要<strong>控制好节奏，把握好时间</strong>，按照演练的内容正常发挥就可以了。</p>
<p>在投标和讲标之后是商务谈判和签订合同等活动，由于一般大家都不会接触（其实是本人并没有接触到），所以就略过啦。</p>
<p>等前期准备都完成了，就可以开始正式的交付阶段了。</p>
<h1 id="交付阶段">交付阶段</h1><p>在交付阶段作为PM关注的点很多，所以分为几个方面来说。</p>
<h3 id="在这一阶段，我们还需要和客户沟通了解以下方面：">在这一阶段，我们还需要和客户沟通了解以下方面：</h3><ol>
<li><p><strong>了解客户项目的上线流程</strong>：比如上线是否需要申请域名，是否有上线前的测试和安全检查等，内部工作流程和规范（需要使用的各种工具，以及是否每次会议结束后都需要发送会议纪要等），文档和报告（日报，周报以及项目交付时需要提供的诸如用户手册、维护指南等文档）。</p>
</li>
<li><p><strong>了解客户如何定义项目成功</strong>：因为对于客户的业务部门、技术部门和我们交付团队，成功的定义并不一样，但是需要我们了解这些不一致，然后相互协调相互妥协，尽量让各方都满意，使项目在交付后每一方都认为项目成功了。</p>
</li>
<li><p><strong>为客户提供统一的接口人</strong>：这并不是说交付团队只有PM和客户沟通而是说不同类型的事物至少客户可以找同一个人解决问题，而不是每次遇到问题，都是需要通过询问才能找到合适的人解决，甚至没有人负责解决问题。例如对于项目管理和人员安排，客户可以找PM；而对于技术架构和实现方面的问题，可以找Tech Lead。</p>
</li>
</ol>
<p>除了了解上述方面，对于客户，尤其是业务部门，通常来说对于交付团队来说都很不放心，<strong>担心进度和实现效果</strong>。特别是对于第一次合作的团队来说更是如此。那我们能怎么样改变这种情况呢？</p>
<ul>
<li><p>首先我们可以通过每天的站会让客户了解我们工作的内容，也便于我们快速解决问题。不过我们需要控制站会的形式，不能把站会变成向汇报或者进行提问的方式。</p>
</li>
<li><p>其次我们可以通过故事墙（物理和电子的）让客户实时看到项目的进展和项目的状态，让他们觉得项目可控。</p>
</li>
<li><p>再次是需要适时而且适度向客户寻求解决问题。这样可以让客户更有参与感和成就感，不过需要控制好度。尽量避免交付团队自己开小会，让客户觉得自己被排除在团队之外。</p>
</li>
</ul>
<p>其实，<strong>最关键的还是我们开发的软件</strong>。不仅是客户，交付团队也是看到了实际的产品之后，才会对项目进度和质量更有信心。</p>
<h3 id="对于我们自己团队来说，需要注意以下几点：">对于我们自己团队来说，需要注意以下几点：</h3><ol>
<li><p>和很多公司不同，我们开始交付之后，并不是一上来就直接开发功能，而是会有<strong>迭代0</strong>的环节，包括交付范围的细化，迭代1的故事卡分析，制定发布计划，进行基础设施的搭建，验证技术可行性等任务。这可以让我们在项目伊始就尽量排除、发现和识别架构和框架以及技术可行性上的问题，迅速进行调整。</p>
</li>
<li><p>我们还需要<strong>和客户建立良好的关系</strong>，让他们意识到我们是在为同一个目标而努力，需要通力合作才能达到那个目标，所以各方需要相互配合与磨合。</p>
</li>
<li><p><strong>在坚持底线和原则的基础上适当妥协，尽量保证客户的满意度</strong>。但是在无法满足或者对于项目进度、质量、人员、成本以及和客户的关系有影响的方面，需要及时和交付保障的同事进行沟通和商量，尽量在萌芽阶段解决问题。</p>
</li>
<li><p><strong>关注并管理客户的期望</strong>。如果项目开发慢了，要及时向客户解释原因，并提供解决方案以及寻求帮助；如果交付快了，不仅需要介绍我们通过何种努力才能加快进度，同时需要介绍可能存在的问题以及可以改进的内容。</p>
</li>
<li><p>在开发过程中<strong>控制好项目的节奏</strong>，不能让团队一直加班或者没有事做，而需要让工作有节奏。对于客户可能提出的996（9点上班，9点下班，每周工作6天）的工作模式，一定要断然拒绝，因为我们希望的是可持续的高效开发，而不是短期的突击。当然这不包括上线前可能会需要加班的突发情况。</p>
</li>
<li><p>为了更好的合作，我们还需要在项目开始就和所有团队成员达成一致，<strong>定义内部工作流程，以及内部沟通机制</strong>，例如微信群和邮件群等。不过需要注意使用的频率，减少客户对于进度的担忧。此外对于和客户的沟通，我们也需要制定沟通计划，例如如何与客户确定需求等内容，什么时候给客户进行演示，以及客户有问题该怎么和团队沟通，以保证既能解决问题，又不会影响团队交付进度。</p>
</li>
<li><p>我们合作的很多客户对于<strong>文档</strong>都是有不少要求的，所以在开发过程中，由于交付压力，客户有可能允许我们延期提交相应的文档，例如设计文档等，但是我们还需要保留好原始材料，等客户需要这些文档时，我们可以通过这些材料快速生成相应的内容，而不是重新做起。</p>
</li>
</ol>
<h3 id="对于PM来说还有哪些职责呢？">对于PM来说还有哪些职责呢？</h3><ol>
<li><p>PM还需要适当<strong>屏蔽干扰</strong>，让团队能集中精力工作，例如尽量减少不相关会议的打扰，以及回答客户随时提问技术细节等情况；同时需要避免压力过多传递到团队成员，例如客户对于需求或者架构的大改变，从而有可能对项目交付进度产生很大压力，PM需要先过滤这些信息，等改变明确后再告知整个团队，这样可以避免传递不确定的信息，避免造成军心不稳的情况。</p>
</li>
<li><p>PM还需要<strong>关注团队成员的精神状态</strong>，用积极的方式影响团队，提高团队士气；同时还要负责好后勤工作，例如开发所需要的各种资源的协调，办公用品等，以及Team Building这些活动。</p>
</li>
<li><p>交付团队还需要不时给客户一定的<strong>震撼和影响</strong>，以使客户对我们更信任。例如采用客户并没有用过的利用画图的方式展示架构图；</p>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Architecture_Map.png" alt="用画图的形式展示架构图"></p>
<p>图 1.5 － 用画图的形式展示架构图</p>
<p>以及，可以用美纹胶带来装饰物力墙，而不是在白板上手动画上歪歪扭扭的线；</p>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Story_Wall.jpg" alt="用美纹胶带来装饰物力墙"></p>
<p>图 1.6 － 用美纹胶带来装饰物力墙</p>
<p>也可以是针对技术问题的在白板上边画边讲的讨论等。</p>
<ol>
<li><p>如果在客户现场工作，客户一般会希望通过学习我们的工作方式提高自己员工的能力，所以我们也可以考虑在不影响进度的情况下，<strong>传播一些项目实践</strong>，例如举行公开的回顾会议等。</p>
</li>
<li><p>在客户现场工作需要注意客户的<strong>网络速度和质量</strong>是否会影响到我们的工作效率。如果发现了问题，一定要尽早解决，尤其是安装开发和生产环境的任务对于网络要求会很高。</p>
</li>
</ol>
<p>虽然现在我经历的第一个国内交付项目还正在如火如荼地进行，但是并不妨碍我畅想一下交付之后的情形。</p>
<h1 id="交付之后">交付之后</h1><p>在项目完成以后，我们还会维护一段时间。这段时间只会就现有的代码问题进行修复，并不会进行功能开发。</p>
<p>对于PM来说，</p>
<ol>
<li><p>PM需要发送<strong>上线邮件</strong>，让团队成员有成就感和荣誉感，也让更多人知道自己项目是做什么的。</p>
</li>
<li><p>PM还需要负责<strong>项目总结</strong>，不仅总结成功的经验，还需要分析出现的问题以及如何避免，让更多的人少走弯路。</p>
</li>
<li><p>最后少不了的就是<strong>团队的庆祝</strong>了，无论是买蛋糕庆祝还是别的活动，团队都需要被激励和感谢。</p>
</li>
</ol>
<p>之后，大家又可以准备投入到新的项目中啦：）。</p>
<p><strong><em>以上的总结更多的是从个人的经验出发，难免会有不足，希望这边文章能使大家在看的时候想到自己遗漏的一些内容，更好更完善地进行项目管理。也欢迎大家的指正。</em></strong></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Delivery/">Delivery</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Domestic-Project/">Domestic Project</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Project-Management/">Project Management</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Mobile_Cloud_Testing_Comparison" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/18/Mobile_Cloud_Testing_Comparison/">移动 app 云测试平台的对比与分析</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/05/18/Mobile_Cloud_Testing_Comparison/" class="article-date">
  <time datetime="2016-05-17T14:00:00.000Z" itemprop="datePublished">2016-05-18</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Testing/">Testing</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>我们都知道在测试移动app时最耗时的是在各种测试设备进行测试， 因为不论是安卓还是iOS都已经碎片化了。而云测试看似是解决这一问题的有效途径。因此选择哪种云测试平台来协助测试人员进行各种测试就成为首要问题。</p>
<h3 id="我们先来看看云测试平台通常都提供哪些功能和服务。">我们先来看看云测试平台通常都提供哪些功能和服务。</h3><p>主流的云测试平台都支持对原生native，混合hybrid和Web app的测试，这些测试包括：</p>
<ol>
<li><p>兼容测试</p>
<p> 通过在多种测试设备上安装／卸载和运行被测app，遍历app的每个界面，主要检查app是否会报错或者崩溃。有些云测试平台还会对每个页面进行截图并进行对比。</p>
</li>
<li><p>脚本测试</p>
<p> 通过运行云测试平台工具进行录制的或者使用自动化测试框架编写的自动化脚本，实现模拟用户操作的目的，并且减少手动测试时间。</p>
</li>
<li><p>性能监控和分析</p>
<p> 利用Android SDK提供的借口，云测试平台可以检测移动app的耗电量，CPU等资源占用率，使用的流量等信息。有些云测试平台还提供自己的SDK，整合在app中可以提供更为准确的性能指标和信息，包括线上app的性能信息以及崩溃信息等。</p>
</li>
<li><p>手动测试和人工测试</p>
<p> 云测试平台的手动测试是指租用云测试平台的特定设备，测试人员手动登录设备进行测试。而人工测试则是将测试需求告知云测试平台的专业测试人员，雇佣他们临时作为自己的测试人员进行测试。</p>
</li>
<li><p>持续集成</p>
<p> 不少提供脚本测试的云测试平台都同时提供对持续集成（Continuous Integration）环境的支持。</p>
</li>
</ol>
<p><strong>此外不少国内云测试平台还提供以下功能：</strong></p>
<ul>
<li>安全测试</li>
<li>内测托管分发</li>
<li>众包测试</li>
</ul>
<h3 id="我们再来看看各种云测试平台对于上述功能和服务的支持情况。">我们再来看看各种云测试平台对于上述功能和服务的支持情况。</h3><p>由于国内外的云测试平台使用环境等因素的不同，我们分别对国内外主流的几个云测试平台进行对比。</p>
<h4 id="国外主流的云测试平台：">国外主流的云测试平台：</h4><ul>
<li>Xamarin Test Cloud (<a href="https://xamarin.com/test-cloud/" target="_blank" rel="external">https://xamarin.com/test-cloud/</a>)</li>
<li>TestDroid (<a href="http://testdroid.com/" target="_blank" rel="external">http://testdroid.com/</a>)</li>
<li>Sauce Labs (<a href="https://saucelabs.com/mobile/" target="_blank" rel="external">https://saucelabs.com/mobile/</a>)</li>
<li>Google Cloud Test Cloud (<a href="https://developers.google.com/cloud-test-lab/" target="_blank" rel="external">https://developers.google.com/cloud-test-lab/</a>)</li>
<li>AWS Device Farm (<a href="https://aws.amazon.com/device-farm/" target="_blank" rel="external">https://aws.amazon.com/device-farm/</a>)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Mobile_Cloud_Testing_Forgien.png" alt="图1 － 国外主流的云测试平台对比"></p>
<p>从上图我们可以看到一些特点：</p>
<ol>
<li><p>在测试设备的数量上，Xamarin Test Cloud和Sauce Labs都是非常有优势的，虽然Xamarin Test Cloud统计的是测试设备的数量，而Sauce Labs是平台的数量；</p>
</li>
<li><p>亚马逊自己的FireOS只被自己的云测试平台支持，在国内我们也能看到类似的例子；</p>
</li>
<li><p>所有的云测试平台都支持app测试，但是只有TestDroid支持游戏测试；</p>
</li>
<li><p>对于国内云测试平台提供的人工测试，安全测试，内测分发和众包测试，国外这些云测试平台都是不支持的，需要结合别的工具和框架进行使用。不过对于手动测试，Sauce Labs和Perfecto这两个云测试平台支持租用测试设备进行手动测试；</p>
</li>
<li><p>对于云测试基础功能的兼容测试，以及脚本测试，崩溃分析和持续集成，这些云测试平台都是支持的；</p>
</li>
<li><p>只有Xamarin Test Cloud，TestDroid和AWS Device Farm支持性能监控；</p>
</li>
<li><p>对于脚本测试所使用的移动app自动化测试框架，每个平台都不甚相同：</p>
<ul>
<li><p>Xamarin Test Cloud支持Calabash（iOS和Android）和自己的Xamarin.UITest;</p>
</li>
<li><p>TestDroid支持很多框架，包括支持iOS的Calabash，appium，UI Automation和 Jasmine，以及支持Android的Calabash，appium，Espresso，Robotium和uiautomator；</p>
</li>
<li>Sauce Labs支持自己的开源框架appium；</li>
<li>Google Cloud Test Lab则支持Espresso，Robotium和Robo test；</li>
<li>AWS Device Farm也支持很多框架，包括支持iOS的Calabash，appium，UIAutomation和XCTest，以及支持Android的Calabash，appium，JUnit，Espresso，Robotium和uiautomator。</li>
</ul>
</li>
<li><p>Xamarin Test Cloud，TestDroid和Sauce Labs都有自己的移动app测试脚本录制工具，分别是：Xamarin Test Recorder，TestDroid Recorder和appium inspector。</p>
</li>
</ol>
<p><strong>综合来看，对于国外的云测试平台，如果侧重的是测试设备的覆盖程度，选择Xamarin Test Cloud和Sauce Labs会更合适；如果需要测试FireOS设备，那就选择AWS Device Farm；如果侧重的是脚本测试中支持的语言和框架，那就可以选择TestDroid和AWS Device Farm；如果是进行游戏测试，只能选择TestDroid；如果要远程连接测试设备进行手动测试，那就需要选择Sauce Labs和Perfecto；如果在测试过程中需要同步监测性能，就不能选择Sauce Labs和Google Cloud Test Lab。</strong></p>
<h4 id="国内主流的云测试平台：">国内主流的云测试平台：</h4><ul>
<li>Testin云测 (<a href="http://www.testin.cn/" target="_blank" rel="external">http://www.testin.cn/</a>)</li>
<li>百度MTC (<a href="http://mtc.baidu.com/" target="_blank" rel="external">http://mtc.baidu.com/</a>)</li>
<li>腾讯优测 (<a href="http://utest.qq.com/" target="_blank" rel="external">http://utest.qq.com/</a>)</li>
<li>阿里MQC (<a href="http://mqc.aliyun.com/" target="_blank" rel="external">http://mqc.aliyun.com/</a>)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/images/Mobile_Cloud_Testing_Domestic.png" alt="图2 － 国内主流的云测试平台对比"></p>
<p>从上图我们也可以看到一些特点：</p>
<ol>
<li><p>Testin云测支持的测试设备数量最多，达到了600部Android和70部iOS终端的数量；但是和Xamarin Test Cloud以及Sauce Labs支持的设备数量还是有不少差距的；</p>
</li>
<li><p>和亚马逊类似，阿里的YunOS也只有阿里MQC才能支持；</p>
</li>
<li><p>和国外的云测试平台很类似，这四个国内云测试平台也都支持app的云测试，而不支持游戏测试；只有Testin云测支持游戏测试；</p>
</li>
<li><p>对于云测试基础功能的兼容测试，国内主流云测试平台都是支持的；</p>
</li>
<li><p>这四个国内云测试平台也都支持崩溃分析，不过对于性能监控，却只有百度MTC支持，而且百度MTC的深度性能测试中还可以做竞品app的性能对比；</p>
</li>
<li><p>Testin云测和百度MTC不支持手动测试；</p>
</li>
<li><p>只有阿里MQC不支持人工测试；</p>
</li>
<li><p>只有Testin云测不支持安全测试；对于支持安全测试的云测试平台，也没有公布是如何进行安全测试的；</p>
</li>
<li><p>Testin云测支持内测分发和众包测试，阿里MQC支持众包测试，其它两个云测试平台对于内测分发和众包测试都不支持；</p>
</li>
<li><p>对于脚本测试，只有腾讯优测不支持；而对于测试工具和框架，各个平台的支持也不相同：</p>
<ul>
<li><p>Testin云测支持Robotium，JUnit，淘宝的Athrun和Testin SDK，其中只有Testin SDK支持iOS和Android，其他框架都只支持Android；</p>
</li>
<li><p>百度MTC只支持通过自己的测试脚本录制工具录制的脚本；</p>
</li>
<li><p>阿里MQC支持Robotium和增强后的appium，其中appium可以支持iOS和Android；</p>
</li>
</ul>
</li>
<li><p>Testin云测，百度MTC和阿里MQC都提供了自己的测试脚本录制工具，分别是itestin录制回放工具，百度MTC录制回放工具和易测；</p>
</li>
<li><p>国内云测试平台都没有提及持续集成，不过从笔者的了解看来，Testin云测和阿里MQC应该是都支持的。</p>
</li>
</ol>
<p><strong>对于国内云测试平台，如果需要覆盖更多的测试设备或者需要测试游戏亦或需要内测分发，只能选择Testin云测；如果需要测试YunOS设备，那就需要选择阿里MQC；如果需要进行性能监控和竞品对比，那就选择百度MTC；如果要远程连接测试设备进行手动测试，那就需要选择腾讯优测和阿里MQC；如果需要雇佣云测试平台的专业测试人员，就不能选择阿里MQC；如果需要进行安全测试，就不能选择Testin云测；如果需要进行众包测试，那就选择Testin云测和阿里MQC；如果要进行脚本测试，就不能选择腾讯优测，对于百度MTC也不推荐。</strong></p>
<p>相信通过对比这些云测试平台提供的功能和服务，以及它们各自的特点，读者在选用云测试平台时有了更多的依据。希望大家在使用这些信息作为依据时，综合考虑这些云测试平台的特点，同时可以使用它们提供的免费试用进行尝试，以便验证是否真的适合自己的app。</p>
<p><strong><em>P.S.以上云测试平台提供的功能及服务，截止于2016年3月20日。</em></strong></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Analysis/">Analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cloud-Testing/">Cloud Testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Comparison/">Comparison</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <article id="post-Mobile_App_Testing_With_22_Rules_English" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/13/Mobile_App_Testing_With_22_Rules_English/">22 Rules In Mobile App Testing</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/05/13/Mobile_App_Testing_With_22_Rules_English/" class="article-date">
  <time datetime="2016-05-12T14:00:00.000Z" itemprop="datePublished">2016-05-13</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Test/">Test</a>
  </div>


      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>[Translated from my Chinese article.]</p>
<p>Nowadays, with the popularization of mobile devices, mobile apps are widely used everywhere, and lots of companies start business in mobile apps field.</p>
<p>This trend brings the challenges to use: we need to deliver the mobile apps to market in time with high quality, and continuously improve them.</p>
<p>We can categorize mobile apps to native apps and hybrid apps. They have many differences compared with Desktop/Web applications, and testers are encountered with more challenges due to the lacks of testing tool and methodology.</p>
<p>With testing a Telecom mobile portal app for more than 2 years, I have summarized some testing experience and practices for native apps on iOS and Android. And most of them are also useful for testing hybrid apps.</p>
<h2 id="1-_Define_your_testing_devices_and_operation_systems">1.    Define your testing devices and operation systems</h2><p>As we all know, the issue of mobile devices’ fragmentation is getting more and more serious, because there are more operation systems with different versions, different hardware of devices, different screen sizes, different resolutions, different pixel densities and etc.</p>
<p>We can’t cover all the devices and operation systems from ROI (Return of Investment) perspective, so we need to choose the testing devices based on the popularization of them in market.</p>
<p>We can not only use Google Analytics or Adobe Omniture to tracking user and generate the devices’ usage report to define testing devices and operation systems, but also read the market share of iOS and Android operation system from their official website:<br><a href="https://developer.apple.com/support/appstore/" target="_blank" rel="external">https://developer.apple.com/support/appstore/</a>, <a href="http://developer.android.com/about/dashboards/index.html" target="_blank" rel="external">http://developer.android.com/about/dashboards/index.html</a>.</p>
<h2 id="2-_Switch_between_networks">2.    Switch between networks</h2><p>The particularity of mobile app is user always use the app on their way, so when we are conducting our testing, we should also focus on the impact of network switch to app. For example we need to cover the scenario of using app on 3G network and then switch to 4G or Wi-Fi or Airplane Mode and so on.</p>
<p>If the app will authenticated on the mobile network and get a token from it then proceed functionalities forward, we will definitely cover the scenario of switching mobile network to other networks.</p>
<p>When we perform testing on network switching scenarios, we need also pay attention to the error message given to user. The error message should be user friendly, and give user instructions to follow to solve the issues.</p>
<h2 id="3-_Multi-tasking">3.    Multi-tasking</h2><p>We usually run multiple apps on our mobile devices, so when we testing mobile apps, we need to consider the app switching.</p>
<p>This includes the scenarios of switching app to another, or close app at background, then how app acts when user open it again: should it reload the info when user left, or it will start from scratch?</p>
<h2 id="4-_Gestures">4.    Gestures</h2><p>Gestures are supported by iOS and Android operation systems, when app introduces it own gestures to user, they would conflict with the system ones.</p>
<p>Such as the wipe gesture to go back introduced in iOS 7: for a long time, to get back one screen, you had to tap the upper left corner on screen (named as “&lt;” or“back” button); on iOS 7, we can swipe the screen to the right and go back.</p>
<p>But before iOS 7 introduced this gesture, many app use this gesture to call out drawer navigation panel in app. At the time when iOS 7 is released, many apps are not ready for this gesture, so when user use this gesture in app, sometimes it will go back, and sometimes it will call out the drawer navigation panel.</p>
<p>Since the user experience for this is so wired, so we should not let this happen from beginning.</p>
<h2 id="5-_User_experience">5.    User experience</h2><p>As we talk about user experience, we are not only focus on the layout and stuff like that, but also test app’s portrait and landscape display.</p>
<p>And we need to check the level of support to accessibility, so that more people can use our app more easily and freely.</p>
<p>We need also check whether app is following the design guide of iOS and Android official documents. Especially for the apps support both iOS and Android operation systems, it’s better to let each app follow the design guide of corresponding operation system, rather than all apps just follow iOS design guide.</p>
<p>And for the apps embedded Webview, if the Webview is not Responsive designed, it will cause display issues on different devices, therefore we may spend lots of efforts to fix them.</p>
<h2 id="6-_Display_messages_and_notifications">6.    Display messages and notifications</h2><p>Since iOS and Android have different notification methods: on Lock Screen, Status Bar, Notification Center and App Icon, we need to check how the messages display when new message come.</p>
<p>When app use sensors or location services, we should also notify user about the changes.</p>
<p>If we consider the cache mechanism in app, the scenarios will be more complex.</p>
<p>Although using cache, we can reduce the workload of server to provide responses to mobile app client, but it complex our testing: we need to make sure once the message is changed, even the cached message is still valid, we should show the updated message, rather than the cached one.</p>
<h2 id="7-_Features_of_Operation_System">7.    Features of Operation System</h2><p>Because iOS starts to support widget since iOS 8, and Android supports widget for a long time, so when we are testing mobile apps, we need to consider widget as a serious feature, and prioritize it in features list.</p>
<p>And for Android apps, we also need to verify when apps are installed and running on both Dalvik and ART runtimes.</p>
<p>For iOS, if app allow user to configure its settings in System Settings, we need to test this feature as well.</p>
<h2 id="8-_Sync_on_different_devices">8.    Sync on different devices</h2><p>Apps like Facebook and Twitter support both iOS and Android; also support multiple devices, such as iPad, iPhone, Android phones and Android tablets.</p>
<p>Some of them allow user to login the same account on different devices. When this happens, we need to check once the message is delivered on one device, this message should be synced to other devices at same time.</p>
<h2 id="9-_Customized_User_Interface">9.    Customized User Interface</h2><p>Besides the OS and hardware differences, different devices may also have different user interface installed, such as Samsung’s Touchwiz, HTC Sense, LG UX and Sony Xperia UI.</p>
<p>For example, Touchwiz has different default font compared to Android native font, which may cause your one line sentence displayed in two lines.</p>
<p>And previously on HTC Sense, you will see a menu bar all the time when using an app, this will affect the display of your app.</p>
<p>Also on HTC Sense 4.x, the multi-tasking screen shows the screenshot of apps, but when you open the app, because the app would refresh, so they may have differences between the screenshot in multi-tasking screen and app current view.</p>
<h2 id="10-_Support_different_file_formats">10.    Support different file formats</h2><p>Sometime we need to display the legal information in mobile apps, usually the legal file are stored as PDF, so it’s hard for app to support this.</p>
<p>One reason is the PDF is usually designed for web or desktop, when viewing it on mobile devices, it’s hard for user to see, even with zoom in.</p>
<p>Another reason is Android doesn’t provide native support for PDF files, unlike iOS. So if we want to display PDF files to user, we need to figure out whether we need to add support to PDF, or we just let user to download one PDF viewer app to open the legal files.</p>
<p>If we need to deal with files in other format, we need to pay more attentions to this.</p>
<h2 id="11-_Support_multiple_countries,_locales_and_languages">11.    Support multiple countries, locales and languages</h2><p>Many countries have immigrants from global, and there maybe more than one language even in one country, so we can’t decide there is only one language for our app.</p>
<p>I know we can’t test with all countries, locale settings and languages, but we can test the widely used languages and corresponding formats, such as English, Chinese, French, Spanish and etc.</p>
<p>We need to verify not only the display of them in app, but also the input of them.</p>
<h2 id="12-_High_memory_usage_actions">12.    High memory usage actions</h2><p>Both iOS and Android have limitations for the memory size can be consumed by app, so when app need to deal with actions need to consume large memory, such as high density images, voices and videos, we need to perform the actions in another process, to avoid the memory leak or app killed by OS.</p>
<p>So we can check this by loading bulk of images, voices and videos. </p>
<h2 id="13-_Non-standard_controls">13.    Non-standard controls</h2><p>On particular OS version, we may want to support some features, which OS can’t provide.</p>
<p>Usually we will implement it by ourselves or using 3rd party library.</p>
<p>One example is theme of app: in iOS 4, we need to implement it all by ourselves from scratch; in iOS 5, we can use UIApperance protocol to reduce some work; and in iOS 7, we can easily use tintColor property to achieve it.</p>
<p>If we are using our self made controls or 3rd party library, we need to pay more attentions when testing, to make sure the behavior the same as other parts.</p>
<p>And as in the example above, with the upgrades of OS, the control may be standardized and provided by OS natively. At that time, we need to merge our codes to native codes, to avoid merging it in the future.</p>
<p>To merge and test the codes are additional efforts compared to implemented it with native codes, so once we need to implement feature by ourselves or using 3rd party library, we need think twice before we actually work on it.</p>
<h2 id="14-_App_upgrade">14.    App upgrade</h2><p>Most app will upgrade gradually, to bring new feature and experience to users.</p>
<p>Once user installed app, when upgrade it, they won’t uninstall it first, but overwrite it or install incrementally.</p>
<p>So we will also test how app behaves after upgrading, especially the user profile stored previously, and other data stored.</p>
<p>We need be more careful if there is app database schema change in app upgrade.</p>
<p>Likewise, we need to verify app stored data are removed after app uninstallation.</p>
<h2 id="15-_Integrate_with_3rd_party_app">15.    Integrate with 3rd party app</h2><p>If app integrate with 3rd party app, such as Google Map or Facebook login, we need to make sure app can perform correctly when 3rd party app doesn’t work properly.</p>
<p>And we also need to monitor the 3rd party app or services.</p>
<p>Sometimes we need to consider to test when 3rd party app integrate with our app and want to share information to our app.</p>
<h2 id="16-_Reduce_dependencies">16.    Reduce dependencies</h2><p>We can try our best to reduce the dependencies to 3rd party system/app/service and other web services we need.</p>
<p>This can help us minimize the complexity of app and reduce the testing efforts.</p>
<p>We also need to use different methodologies to make sure they work fine, such as API and integration testing and monitoring.</p>
<h2 id="17-_Automation_and_Exploratory_testing">17.    Automation and Exploratory testing</h2><p>Many companies and teams are using Agile now, so TDD and API testing are implemented in development.</p>
<p>For UI automation, we should use Test Pyramid to design our test first, then only automated test scenarios based user journey. </p>
<p>Because unit test can cover the functionalities in every activity and view, but they can’t help us when we are testing the interactions between activities and views.</p>
<p>Likewise, when we conduct exploratory testing, we should focus on the workflows with data in them, and the ways the activities/views interact with each other.</p>
<p>I suggest you to use simulator or emulator to do automation, and if you are testing Android apps, Genymotion is a good choice for you; and for exploratory testing, we probably can use devices.</p>
<p>For the automation tools, they are plenty of them: appium, Frank, Calabash, UIAutomation, UiAutomator and so on.</p>
<h2 id="18-_Security_testing">18.    Security testing</h2><p>Both iOS and Android support app to store their data in local SQLite databases, so we need to make sure the databases are encrypted.</p>
<p>We can also use tools like iPhone Configuration Utility and Android DDMS to sniffer the web traffic, checking whether there is cleartext in the request and response.</p>
<p>To test the security of mobile services, we can use the same way when we testing Web applications.</p>
<h2 id="19-_Performance_testing">19.    Performance testing</h2><p>Performance testing can be also involved in mobile app testing.</p>
<p>It includes testing the app in slow network connection, batch load large quantity of data and such scenarios.</p>
<p>We can also test the performance of mobile services.</p>
<h2 id="20-_Operation_System_upgrade">20.    Operation System upgrade</h2><p>Different with app upgrade, when operation system is going to upgrade, Apple and Google will let developers know in advanced, so that they can prepare their app to follow the new rules (guides :P).</p>
<p>When we testing the existing app, we need also to learn the changes introduced in new OS version, and prepare for them technically and in mind.</p>
<p>When the app for new OS is developing, we will cover the tests for both existing app and the new app at same time.</p>
<h2 id="21-_Benefits_from_Log">21.    Benefits from Log</h2><p>In developing stage, we usually use Crashlytics, HockeyApp and such tool to collect crash issues, which can make the life for both developers and testers much easier.</p>
<p>And we can also us iPhone Configuration Utility and Android DDMS to collect general app logs.</p>
<p>When releasing app to market, it’s better we can have some ways to collect the crash information, either to ask user to give feedbacks or ask user to allow app to send logs to us when necessary.</p>
<h2 id="22-_Continuous_integration_and_continuous_deployment">22.    Continuous integration and continuous deployment</h2><p>We can use continuous integration to help us find the stability issue and build a safe net for us.</p>
<p>Although we can’t 100% automate the process of continuous deployment, we can try our best to ease it, such as using TestFlight to distribute iOS apps, while using HockeyApp and other tools to distribute Android apps.</p>
<p>An alternative way to distribute Android app is using Dropbox: we can install Dropbox on the app package desktop and testing devices, once the app is packaged, we can use script to move it to the Dropbox folder on the packaging desktop; after Dropbox sync the apk file, we can open Dropxbox on testing devices to install the app.</p>
<p><br><br>I know those practices and sharing won’t solve all the problems and fix all the issues, but hope they can inspire you.</p>
<p>Since mobile apps are evolving, so does the mobile app development and testing. We will have new tools, techniques and methodologies in this trend. I am looking forward to hear your thoughts about mobile testing.</p>
<p>You can also find my presentation <a href="https://raw.githubusercontent.com/hy1984427/hy1984427.github.io/master/documents/22Rules_In_Mobile_App_Testing.pdf" target="_blank" rel="external">here</a>.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/App-Testing/">App Testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rules/">Rules</a></li></ul>

      </footer>
    
  </div>
  
</article>








    
      <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Далее &raquo;</a>
      </nav>
    </section>
    
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Huang Yong&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>

    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>
